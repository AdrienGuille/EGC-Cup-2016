Echantillonnage adaptatif de jeux de données déséquilibrés
pour les forêts aléatoires
Julien Thomas∗,∗∗, Pierre-Emmanuel Jouve∗, Elie Prudhomme∗∗
∗Société Fenics Lyon, France.
∗∗Université Lumière Lyon 2, Laboratoire ERIC.
Résumé. Dans nombre d’applications, les données présentent un déséquilibre
entre les classes. La prédiction est alors souvent détériorée pour la classe mino-
ritaire. Pour contourner cela, nous proposons un échantillonnage guidé, lors des
itérations successives d’une forêt aléatoire, par les besoins de l’utilisateur.
Introduction Les jeux de données déséquilibrés constituent un problème important de l’ap-
prentissage supervisé. Or la plupart des modèles sont conçus pour des données équilibrées.
Leur utilisation sur des données déséquilibrées conduit souvent à une mauvaise prédiction de
la classe minoritaire. Pourtant, cette situation se retrouve régulièrement dans la pratique (Dé-
tection de pannes (Pazzani et al., 1994), textmining, aide aux diagnostics médicaux...). Ces
applications ont besoin de disposer de méthodes capables de prédire la classe minoritaire avec
des performances en adéquation avec les attentes de l’utilisateur. L’évantail des solutions exis-
tantes vont de l’échantillonnage (Japkowicz, 2000; Chawla et al., 2002), à la construction d’un
modèle de prédiction spécifique à la classe d’intérêt, en passant par l’utilisation de matrices de
coût (Pazzani et al., 1994; Kubat et al., 1998).
FUNSS L’idée de FUNSS (Fitting User Needs Sampling Strategy) est de traduire le besoin
en rappel pour la classe minoritaire en terme de marge de décision entre les individus de chaque
classe. Les individus minoritaires (positifs) sont entourés par une quantité importante d’indivi-
dus majoritaires (négatifs) qui empèchent le classifieur de les apprendre correctemment. Pour
augmenter le rappel, une solution consiste à choisir des individus négatifs éloignés des indivi-
dus positifs. A l’inverse, pour augmenter la précision, il suffit de garder les individus négatifs
proches des individus positifs. FUNSS reprend ce principe en modifiant l’échantillonnage réa-
lisé au cours des forêts aléatoires en un échantillonnage dirigé. A chaque tirage avec remise,
le processus est le suivant : si l’individu est positif, il est intégré dans le nouvel échantillon ;
sinon un groupe de n individus négatifs est tiré ainsi qu’un individu positif. L’individu négatif
du groupe qui est soit le plus proche, soit le plus éloigné de l’individu positif est intégré dans
le nouvel échantillon. Chaque échantillon de la forêt aléatoire est donc l’occasion d’augmenter
ou de diminuer le rappel pour atteindre une valeur fixée par l’utilisateur. Pour cela, le rappel de
la forêt est estimé à chaque nouvel arbre à l’aide des individus out-of-bag. S’il est en dessous
du rappel désiré, l’échantillonnage suivant sélectionne des individus négatifs éloignés. Dans le
cas contraire, les individus négatifs proches sont favorisés. Enfin pour déterminer l’individu le
plus proche d’une cible, les individus sont ordonnés pour chaque attribut sur leur proximité à
cette cible. La distance utilisée est alors la somme des rangs d’un individu.
