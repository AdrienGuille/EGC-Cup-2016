Un nouvel algorithme de classification
spatiale
Mohamed Che´rif Rahal
CEREMADE - Universite´ Paris Dauphine, Place du mare´chal de lattre de tassigny, 75775
Paris cedex 16
rahal@ceremade.dauphine.fr
Re´sume´ La classification spatiale ge´ne´ralise la classification hie´rarchique et pyra-
midale au cas ou` les objets a` classer sont projete´s sur une grille au lieu d’une simple
droite. Nous pre´sentons dans cet article un nouvel algorithme qui permet d’obtenir
une structure classifiante spatiale en utilisant de nouvelles agre´gations.
Keywords : Classification pyramidale, Classification spatiale. . .
1 Introduction
La classification spatiale de donne´es (Voir [7] et [6]) qui nous inte´resse ici, s’applique a`
tout type de donne´es ou` n individus sont caracte´rise´s par p variables descriptives (qu’elles
soient classiques ou symboliques). Elle a pour objectif d’associer ces individus a` chaque
nœud d’une grille et d’en extraire simultane´ment une structure classifiante « compatible »
avec cette grille (sans croisement). La classification ascendante spatiale est donc une
extension de la classification ascendante pyramidale et hie´rarchique ou` les individus de
l’ensemble a` classer sont place´s sur un maillage planaire (appele´ e´galement grille ou re´seau)
au lieu d’une droite. Le but d’une telle classification est d’offrir en sortie non seulement une
structure classifiante (syste`me de classes sous forme d’ensemble) mais aussi un mapping
des e´le´ments a` classer sur le maillage, qu’il soit re´gulier ou non . Ceci rend l’interpre´tation
du voisinage entre objet et entre classes plus aise´e.
Les pyramides spatiales sont construites de la meˆme manie`re que les hie´rarchies [1] et
les pyramides [5] « classiques », sauf qu’a` chaque individu de la population a` classifier est
associe´ un nœud d’un re´seau qui peut eˆtre de dimension quelconque au lieu d’eˆtre line´aire.
La construction de telles structures s’inspire des me´thodes ascendantes de classifica-
tion - hie´rarchique (CAH) (voir [1]), 2/3-hie´rarchique (2/3-CAH) (voir [4]) et pyramidale
(CAP) (voir [5] et [2]) - et de leurs algorithmes sous-jacents. S’appuyant sur un algorithme
ascendant (de la base au sommet), on agre`ge successivement les objets les plus proches,
sous certaines conditions, pour obtenir une structure de graphe spatiale (en trois dimen-
sions). Ce graphe repre´sente aussi bien la structure des classes obtenues que l’indic¸age
ou la hauteur de ces classes, exprimant ainsi la proximite´ entre les objets ou les groupes
d’objets ayant e´te´ agre´ge´s. Les conditions d’agre´gation diffe´rent selon la structure classi-
ficatrice de´sire´e : dans le cas des hie´rarchies (planaires ou spatiales) chaque objet ne peut
eˆtre agre´ge´ qu’une seule fois ; dans le cas des pyramides chaque objet est agre´geable deux
fois dans le cas standard et quatre fois dans le cas spatial.
c© Revue MODULAD, 2010 -118- Nume´ro 42
2 Quelques de´fintions
2.1 De´finition d’un m/k-maillage
C’est un graphe dont chaque sommet est le point de rencontre d’un maximum de
m areˆtes formant m angles conse´cutifs e´gaux strictement positifs et dont les plus petits
cycles (i.e. ceux qui contiennent le minimum de sommets) contiennent k areˆtes de meˆme
longueur et forment des « cellules » de surface non nulle qui partitionnent et couvrent
l’espace dans lequel il est projete´.
Fig. 1 – Types de grille (maillages) re´gulie`res planaires (2D) : (a) grille hexagonale, (b)
grille triangulaire, (c) grille rectangulaire avec des cellules carre´es
.
2.2 De´finition d’une pyramide spatiale
Une pyramide spatiale est un ensemble note´ P de parties non vides de E appele´es
paliers ou classes, satisfaisant les proprie´te´s suivantes :
– E ∈ P ;
– pour tout ω dans E, {ω} ∈ P ;
– pour tous pi et pj dans P, pi ∩ pj = ∅ ou pi ∩ pj ∈ P ;
– il existe un maillage G tel que chaque sommet gij de G est associe´ a` un e´le´ment de
E et sur lequel les e´le´ments de P forment des convexes.
De´finition 2.1 Composante convexe
Soit C ∈ P associe´e a` un ou plusieurs paliers connecte´s occupant une sous-grille g de G.
g est dite composante convexe ssi :
pour tout couple de nœuds de g le plus court chemin les reliant est dans g.
La figure 2 illustre une pyramide en construction sur une grille re´gulie`re de taille
4 × 6, cette pyramide est constitue´e de trois paliers maximaux convexes suivants : A =
{ω20, ω21, ω18, ω19} ,B = {ω12, wω16, ω17, ω13, ω14, ω15} etD = {ω11, ω10, ω9, ω6, ω7, ω8, ω3, ω4, ω5}
et d’un palier segment C = {ω1, ω2}, chacun de ces paliers est repre´sente´ par une partie
sur la grille. Remarquons que les paliers A,B,B1, B2, D,D1, D2, D3, D4 sont des palier
auxquels sont respectivement associe´s les convexes suivants sur la grille :
Conv(A), Conv(B), Conv(B1), Conv(B2), Conv(D), Conv(D1), Conv(D2)
Conv(D3), Conv(D4).
c© Revue MODULAD, 2010 -119- Nume´ro 42
Fig. 2 – Exemple d’une pyramide spatiale en construction, la grille et les diffe´rents
convexes associe´s aux paliers
3 Les agre´gations spatiales
Nous de´taillons et e´tudions dans ce qui suit les diffe´rentes agre´gations possibles prises
en compte par l’algorithme de classification spatiale que nous pre´sentons dans les pro-
chaines sections. Ces agre´gations de´pendent d’une part du type de paliers a` agre´ger et
de leurs formes d’autres part, par formes nous faisons allusion aux diffe´rentes structures
« ge´ome´triques » qui leur sont associe´es sur la grille (convexes, segments connexes, ou
singletons (un point sur la grille)).
Conditions d’agre´gation
On pre´sente dans ce qui suit les conditions d’agre´gation de deux paliers. On distingue
essentiellement deux cas, le premier est celui ou` les deux paliers se trouvent dans la meˆme
composante convexe, quant au second il est celui ou` les deux paliers sont dans deux
composantes diffe´rentes. Dans le premier cas, il faut que les paliers soient connecte´s ou
voisins pour que l’agre´gation puisse se faire, dans le deuxie`me cas les deux paliers doivent
eˆtre soit maximaux ou a` la frontie`re des composantes convexes qui les contiennent.
Soient h et h′ deux paliers de la pyramide en construction P.
Selon les deux cas suivants on dira que h et h′ sont agre´geables si les conditions suivantes
sont ve´rifie´es :
Cas 1 : h et h′ appartiennent a` la meˆme composante convexe
– h et h′ sont voisins ou connecte´s.
– h et h′ n’ont pas e´te´ agre´ge´s quatre fois.
Ou
– h est au nord (resp. au sud) de h′ et il n’existe pas de palier h′′ tel que h est au nord
(resp. au sud) de h′′ et h′′ est au nord (resp. au sud) de h′.
Ou
– h est a` l’est de (resp. a` l’ouest) h′ et il n’existe pas de palier h′′ tel que h est a` l’est
(resp. a` l’ouest) de h′′ et h′′ est a` l’est (resp. a` l’ouest) de h′.
– il n’existe pas de palier tel que h ou h′ soient a` l’inte´rieur de ce palier.
Cas2 : h et h′ n’appartiennent pas a` la meˆme composante convexe
c© Revue MODULAD, 2010 -120- Nume´ro 42
Soient C et C ′ les deux composantes convexes auxquelles appartiennent respectivement
les paliers h et h′ alors :
– h et h′ doivent eˆtre a` la frontie`re de C et de C ′.
– les composantes convexes relatives a` h et h′ soient Conv(h) et Conv(h′) doivent
avoir au moins un cote´ de taille e´gale (une bordure de meˆme taille). Cette condition
est e´tablie afin de garantir la convexite´ du palier re´sultant sur la grille.
4 Cas et types d’agre´gations
Il existe dans notre algorithme plusieurs cas d’agre´gations, ces cas de´pendent d’une
part des types de paliers a` agre´ger et des formes ; convexes ou autres ; qui leurs sont
associe´es sur la grille d’autre part. Les cas d’agre´gations envisage´s dans notre algorithme
sont e´nume´re´s ci-apre`s :
Construction des paliers segments et de chaˆınes connecte´es
Agre´gation de singletons
Puisqu’il s’agit d’une classification pyramidale spatiale ou` chaque palier (i.e. classe)
peut eˆtre agre´ge´ au plus quatre fois, et afin d’aboutir aux premiers convexes de la pyra-
mide, nous autorisons la construction de paliers connexes. En effet, un palier connexe est
duˆ a` l’agre´gation de deux singletons en satisfaisant certaines conditions d’agre´gation. On
agre`ge deux singletons {ωi}, {ωj} s’ils n’ont pas e´te´ agre´ge´s quatre fois. Il existe deux cas
possibles. Le premier cas est le plus simple, il s’agit d’agre´ger deux singletons n’apparte-
nant a` aucun autre palier de´ja` construit. Dans le deuxie`me cas, les singletons ont de´ja` e´te´
agre´ge´s (appartiennent soit a` un palier convexe soit a` un palier connexe). Nous de´taillons
dans ce qui suit ces cas de figure :
– cas 1 : les deux singletons sont libres (i.e. n’ayant pas encore e´te´ agre´ge´s). C’est le
cas d’agre´gation le plus simple, dans ce cas on agre`ge les deux singletons {ωi} et
{ωj} en un palier connexe h = {ωi} ∪ {ωj} auquel sera associe´ un segment connexe
Scon(h) = 〈ωi, ωj〉.
– cas 2 : un singleton est libre et le deuxie`me est de´ja` agre´ge´. Dans ce cas, le singleton
ayant de´ja` e´te´ agre´ge´ (moins de 4 fois) peut appartenir a` un ou plusieurs paliers
connexes ou convexes. Dans le premier cas, il n’y a aucun proble`me d’agre´gation
qui se pose, on agre`ge les deux singletons.
Construction de paliers convexes
– Agre´gation de paliers segments
Ce type d’agre´gation est purement hie´rarchique puisqu’elle vise a` former les premiers
paliers convexes de la pyramide spatiale a` partir de deux paliers segments, on ope`re
exactement de la meˆme manie`re que dans l’algorithme PyrSpat de Pak [7] pour
l’agre´gation de paliers « temporaries » afin de former des paliers dits « de´finitifs ».
– Agre´gation de paliers convexes
On agre`ge deux paliers h et h′ constituant respectivement les convexes g = conv(h)
et g′ = conv(h′) sur la grille s’ils ont un cote´ de meˆme taille autrement dit si l’une
des conditions suivantes est ve´rifie´e :
c© Revue MODULAD, 2010 -121- Nume´ro 42
Fig. 3 – Illustration du cas d’agre´gation 2 d’un singleton libre avec un singleton de´ja`
agre´ge´
– g et g′ ont la meˆme taille
– longueur(g) = longueur(g′)
– largeur(g) = largeur(g′)
– longueur(g) = largeur(g′)
– largeur(g) = longueur(g′)
En effet, ces conditions garantissent la convexite´ sur la grille du nouveau palier
re´sultant.
– Agre´gations convexe-connexe
Au de´but de l’algorithme de classification spatiale, il est ne´cessaire de construire
des paliers segments qui ne seront pas repre´sente´s, e´tant donne´ qu’ils ne forment
pas de convexe et ne respectent donc pas la quatrie`me proprie´te´ de la de´finition
d’une pyramide spatiale. Ne´anmoins ces paliers doivent eˆtre pris en compte pour la
construction des premier convexes, nous utiliserons pour ce faire les meˆmes condi-
tions d’agre´gation propose´es dans [7] pour l’agre´gation de paliers temporaires, nous
obtiendrons ainsi les premiers convexes de la pyramide, mais en plus puisque l’al-
gorithme que nous proposons ici construit directement la pyramide spatiale, nous
devons autoriser la possibilite´ qu’un palier segment puisse s’agre´ger avec un convexe
pour en former un nouveau convexe, ce cas d’agre´gation est illustre´ par la figure 5.
5 S’CAP un nouvel algorithme de classification spa-
tiale
Nous de´crivons dans cette section l’algorithme S’CAP de construction d’une pyramide
spatiale qui est base´ sur l’algorithme pre´sente´ dans [6]. Cet algorithme prend en entre´e :
– une matrice D de taille n × n exprimant la distance - ou la dissimilarite´ - entre
chaque couple d’e´le´ments de l’ensemble a` classer E
– la taille de la grille Gl×w sur laquelle seront projete´s les individus de E et les convexes
c© Revue MODULAD, 2010 -122- Nume´ro 42
Fig. 4 – Illustration de deux cas d’agre´gations convexes (rectangulaire)
Fig. 5 – Illustration de l’agre´gation d’un palier convexe avec un palier segment
c© Revue MODULAD, 2010 -123- Nume´ro 42
associe´s aux paliers construits
– mesure d’agre´gation ρ entre les parties de E.
Dans ce qui suit, nous pre´sentons une formulation du pseudo-algorithme du nouvel
algorithme de classification spatiale :
– E´tape 1 : Initialisation
– Les seuls paliers construits sont les singletons de E, f({ω}) = 0, ∀ω ∈ E.
– E´tape 2 : Agre´gation
– On re´unit les deux paliers « actifs » h∗ et h′∗ tel que ρ(h, h′) soit le minimum de ρ
parmi les paliers h et h′ qui ve´rifient les conditions d’agre´gation de´finies dans 3.
– A Chaque fois qu’un palier convexe est construit, on le place sur la grille.
– E´tape 3 : Mise a` jour
– On met a` jour la liste des candidats
– On met a` jour la grille et les positions des nouveaux convexes s’il y a eu de´placement,
rotations ou changement de coordonne´es.
– On met a` jour la matrice de dissimilarite´ en fonction des nouveaux paliers construits.
– E´tape 4 : Test d’arreˆt
– On revient a` l’e´tape 2 tant que le palier co¨ıncidant avec E n’est pas construit.
Lors de la phase d’initialisation, nous cre´ons les singletons de la pyramide et nous initiali-
sons les ensembles des segments Seg (ensemble vide au de´part) et l’ensemble des convexes
Cv. La pyramide en construction contient au de´part de l’ensemble des singletons, on
conside`re que les singletons qui occuperons des nœuds de la grille sont des convexes, ils
seront donc inte´gre´s dans l’ensemble Cv.
E´tape d’agre´gation
Dans cette e´tape, on cherche les couples de paliers actifs agre´geables qui respectent les
conditions de la section 3 et les cas d’agre´gation e´nume´re´es dans 4 et qui repre´sentent
la valeur minimale de la matrice de dissimilarite´. On agre`ge donc ces deux paliers et on
passe a` l’e´tape de mise a` jour.
E´tape de mise a` jours
Lors de l’e´tape de mises a` jour
– on recalcule les positions des convexes en cas de de´placement ou de rotation,
– on met a` jour l’ensemble des paliers actifs,
– on met a` jour les ensembles de successeurs du palier cre´e´ et l’ensemble de pre´de´cesseurs
des paliers agre´ge´s,
– on met a` jour la matrice de dissimilarite´.
Remarquons que nous utilisons deux ensembles Cv et Seg dans lesquels sont range´s res-
pectivement les paliers convexes et segments construits au fur et a` mesure de l’e´volution de
l’algorithme. La recherche de paliers agre´geables se fait dans les deux ensembles, puisque
selon les conditions d’agre´gation, on peut construire plusieurs types de paliers (voir 4).
L’algorithme s’execute en trois e´tapes, une e´tape d’initialisation qui consiste en la cre´ation
des paliers triviaux de la pyramide (i.e. les singletons) et qui initialise les ensembles Seg
et Cv ainsi que la matrice de distance, une e´tape double d’agre´gation et de mise a` jour,
lors de l’agre´gation on construit les nouveaux paliers de la pyramide en se basant sur la
matrice de dissimilarite´ d’une part et sur les positions et les tailles des convexes d’autre
part, enfin l’e´tape de mise a` jour qui permet la re´organisation des paliers nouvellement
c© Revue MODULAD, 2010 -124- Nume´ro 42
construits sur la grille, la suppression des paliers ayant e´te´ agre´ge´s quatre fois ainsi que
le recalcul de la matrice de dissimilarite´.
La diffe´rence majeure entre le nouvel algorithme de classification spatiale et PyrSpat
est la construction de paliers convexes formant des rectangles sur la grille, ces paliers sont
dus aux nouveaux cas d’agre´gation introduits dans ce papier (voir les sections 3 et 4).
Fig. 6 – Exemple de trois types de visualisation possibles de pyramides spatiales
de´veloppe´s dans cadre du Projet ANR SEVEN(LIMSI)
6 Conclusion
Dans ce papier nous avons pre´senter d’une manie`re non exhaustive un nouvel al-
gorithme de classification spatiale en utilisant de nouvelles agre´gations. Cet algorithme
est une ge´ne´ralisation des travaux de [7] et [6], son originalite´ re´side dans le fait qu’on
puisse directement construire une pyramide spatiale sans passer par une hie´rarchie ou par
un ordre pre´de´fini sur les individus de de´part (comme c’est le cas dans [7]) mais aussi
permettre la cre´ation de paliers convexes rectangulaires ce qui n’est pas traite´ dans les
algorithmes pre´ce´dents. On cherchera a` chaque e´tape les deux groupes qui minimise la
distance deux a` deux et dont l’union forme un convexe sur la grille qu’il soit carre´ ou
rectangulaire.
c© Revue MODULAD, 2010 -125- Nume´ro 42
Re´fe´rences
[1] Benzecri, J.-P. : L’analyse des donne´es tome 1 : La taxonomie, Paris : Bordas (1980)
[2] Bertrand, P. et Diday, E. (1990). Une ge´ne´ralisation des arbres hie´rarchiques : les
repre´sentations pyramidales. Revue de Statistique Applique´e, 38 :53,78.
[3] Bertrand, P. (1986). Etude de la repre´sentation pyramidale. The`se de 3e cycle, Uni-
versite´ Paris Dauphine.
[4] Bertrand, P. (2008). Systems of sets such that each set properly intersects at most one
other set-application to cluster analysis. Discrete Appl. Math., 156(8) :1220,1236.
[5] Diday, E. (1984). Une repre´sentation visuelle des classes empie´tantes. Rapport de
recherche, INRIA.
[6] Diday, E. (2008). Spatial classification. Discrete Appl. Math., 156(8) :1271 ;1294.
[7] Pak, K. (2005). Classifications Hie´rarchique et Pyramidale Spatiales. The`se de docto-
rat, Universite´ Paris Dauphine.
c© Revue MODULAD, 2010 -126- Nume´ro 42
