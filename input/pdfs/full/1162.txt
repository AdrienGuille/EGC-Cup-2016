EUROPEAN WORKSHOP ON DATA STREAM ANALYSIS • March, 14-16, 2007 • Caserta, Italy
71© Revue MODULAD, 2007
Numéro 36
EUROPEAN WORKSHOP ON DATA STREAM ANALYSIS • March, 14-16, 2007 • Caserta, Italy
72© Revue MODULAD, 2007
Numéro 36
EUROPEAN WORKSHOP ON DATA STREAM ANALYSIS • March, 14-16, 2007 • Caserta, Italy
73© Revue MODULAD, 2007
Numéro 36
EUROPEAN WORKSHOP ON DATA STREAM ANALYSIS • March, 14-16, 2007 • Caserta, Italy
74© Revue MODULAD, 2007
Numéro 36
1Smart Alarming Methods:
an overview,  
highlight on statistical methods
Jean-Paul Valois1, 
Christophe Blondeau1, 
Simplice Dossou-Gbete2, 
Laurent Bordes2
1
2jean-paul.valois@total.com
Caserta, 14-16 mar. 07
Background, objective 
2 -
23 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
General Topic, objective of Smart alarming
DEFINITION / PURPOSE
 to detect any change (novelty) before it becomes obvious, 
 to describe it,
 if needed (or possible) : thus prevent its consequences
NEEDS
 An automatic “black box” procedure is often the final product
General framework by G. Cormode yesterday
4 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Aim of the present paper
Exhibit the guide lines to correctly design an industrial project
A bibliographic investigation 
In some cases :
 programming selected methods
 experimentation on synthetic data sets or real data sets from oil
industry
A large variety of statistical methods
because a lot of diversified concrete situations
The overviews most often take first into account the type of algorithms
see Marcou & Singh, 2003,   Hodge 2004.
A large variety of statistical methods
because a lot of diversified concrete situations
The overviews most often take first into account the type of algorithms
see Marcou & Singh, 2003,   Hodge 2004.
Î Which questions to be posed to conceive a smart-alarming work flow ?
35 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
A panorama of the methods
DATA
UNIVARIATE  = 1 var. vs Time
MULTIVARIATE
stationnary un-stationnary
a priori unknown
or a quite new situation
could occur
NOVELTIES :
a priori known & described
= metadata, 
technical knowledge
previous expert diagnostic, etc
NOVELTIES :
Constraints on the task
Constraints on the data
+ Training file No training file
Including novelties, or not…
Here : only quantitative variables
6 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Univariate*         Stationnary
Data    
6 -
* or the variables can be taken separately
=> no correlation between them
Unknown novelty
47 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Even in this simplest case,
You can be faced with different situations
(3) A lack of very cold winters
(2) A repetition of both
hotter sommers
colder winters
(1) An exceptional frost
stationary data
8 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Even in this simplest case,
You can be faced with different situations
Threshold (ex: 3 σ) is the basic concept
used as indicator
in a lot of more sophisticated methods
3 σ
stationary data
59 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Basic threshold method should sometimes be adapted
σ in a sliding window
3 σ
3 σ
(raw data : 3 * threshold)
1+(m/σ) in a mobile window 3 σ
σ not suitable
10 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
A data preprocessing can be needed
Several methods :
•difference with the base signal
•Fourier transform, 
•wavelett
•…
611 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
+ weigth
stationnary data
last value is active in the model
a, b could change in case of novelty
drift
b
a
b
a
When the novelty is a drift
Linear Regression in a sliding window
Model :        y = a * time + b
12 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
drift
b
a
b
a
stationnary data
PCA
713 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Univariate*       Stationnary
novelty Data   
13 -
* or the variables can be taken separately
=> no correlation between them
Unknown novelty
Change point analysis
TAYLOR (2000),  Æ synthesis + multilevel approach
WEISHAUPT et al, 1991, Rig Computer system improves Safety for deep HP/HT
wells by kicks detection and well monitoring, SPE 23053
PAGE (1955,1957), 
HINKLEY (1971), PETTITT (1980), Æ Cusum
HINKLEY  SCHECHTMAN (1987) Æ Boostrap
14 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
y
Time
Bootstraps i   (1..n) In case of 2 trends, range (0)  is higher
y
CUSUM (k) = CUSUM (k-1) + (  y( k) – y  )
Proba. test
Yes No
LOCALISATION
DIAGNOSTIC
MULTILEVEL ANALYSIS
range0
rangei
If no change point:
Range0 does not
differenciates
1000 b.
range
(0)
?
Data by Taylor (2000)
815 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
DISCUSSION (Taylor)
•Reasonnably robust. If needed, use the ranks.
•More flexible than control chart.
•Can detect minor shifts of the mean
•Not suitable for detecting isolated high values.
•COMMENT 
•Is not a really on line method, rather an a posteriori one
EXTENSION
Using X’= (Xi – Xi-1) instead of (Xi),   as suggested by Taylor
to diagnose evolutions
Could then the CHANGE POINT method handle no-stationnary data ?
16 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Xi – Xi-1
OK
Trend – 1 change point
Very low noise
Trend – 1 change point
Moderate noise
Range0 < Rangei !!
Trend – No change point
i i
OK
ARTIFACT !
X’ = (Xi + ε)  – (Xi-1 + ε))
917 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
“a” parameter, Regression in a mobile window
Change point method
18 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
100 boots.
1000 boots.
Regression 100 boots.Cusum on residuals
OK
OK
OK
Residuals
10
19 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Change point method
is adapted to detect shift of the mean,        OK with Taylor
is only suitable for stationnary data :          not clearly mentionned by Taylor
In case of no-stationnary data
+ noisy data,    better use residuals of regression
20 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Univariate*         Stationnary
Data   
20 -
* or the variables can be taken separately
=> no correlation between them
Known novelty
See :
SEAGULL and SANDERSON, 1998, Anesthesia alarms 
in surgical context, 
Proceeding of the human factors and ergonomics society 42nd annual 
meeting
Median method
11
21 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Time
LEARNING file :
p individuals with anomalies
1
2
p
τmax
0  … thresholds … τmax
VALIDATION of the APT
Choose one threshold
« Adim. Potential Th. »
? Best correlation Fij vs Yk-1
VALIDATION files (1..m…Z) :
p’ individuals with anomalies or not
Time
1
2
p’
τ = Med k+1/ Med k
Fij =
Frequency of τj > i
1       ….      i    ….            n
1
2
j
p
22 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
VALIDATION Using the selected Adim. Potential Th.
with without
fA fB
fC fD
with
without
fA
fA + fC
Se(m)=
fB
fB + fD
Sp(m)=
Known Anomaly
Alarm
Optimizing!
Se(m)
1 – Sp(m)
x Val. file m
1
1
1− α
β 5%
0
12
23 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
MULTIvariate Stationnary
Data   
23 -
Unknown novelty
P.C.A. 
HARKAT, 2003, Détection de défauts par analyse en composantes
principales, Doctorat de l’Institut Polytechnique de Lorraine, laboratoire CRAN
Air survey
24 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Training Data Set
F1
F2
F3
+ New Data
Model
Without novelty
F1
F2
F3
New data set
= passive obs.
MODEL 1
F’1
F’2
F’3
New data set
= active
MODEL  2
13
25 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
F1
F2
F3
Optimal Space Residual Space
F8
F7
λ= 1
or …
MODEL 1    New data taken as passive ones
F4,5,6,7,8        F5,6,7,8        F7,8         F8
Sub-spaces
T4,α T3a             T2a       T1a
?>
?> <
<<<No anom.
T = f (alpha, Kth Eig. Val.) 
D4                D3              D2          D1Test
Threshold
Scores 
D =  for each obs, Σ Fij in the K dim. subspace
26 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Time
PCA (Harkart)
Pump efficiency
Vitesse pompe
Oil rate
A REAL CASE
Temps Speed   
Torque
Pump Eff
Speed
Rate
None
Time
When ? Which variable ?
14
27 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
MODEL 2   ACP using a sliding window
F’1
F’2
F’3
F’1
F’2
F’3
F’1
F’2
F’3
? Stability of the correlations (variables, factors) ?
No stat. Test =>  empirical threshold
temps
28 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Needs stationnary data set + a training set without novelty
Detection with a short delay
Can detect simoultaneous novelties in several variables
PCA by Harkart
15
29 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
MULTIvariate Stationnary
Data   
29 -
Novelty known or not
Clustering
30 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
+ New Data
Training Data Set Model
Classe 1
Classe 2
Classe 3
Classe 1
Classe 2
Classe 3
No novelty
Classe 1
Classe 2
Classe 3
Classe 4
Novelty
= Alarm ?
or new normal situation ?
TRAINING DATA SET WITHOUT NOVELTY
CLUSTERING
16
31 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
+ New Data
Training Data Set Model
Classe 1
Classe 2
Classe 3
Classe 1
Classe 2
No novelty
Classe 1
Classe 2
Classe 4
Alarm,
or new normal
Situation ?
TRAINING DATA SET WITH NOVELTY
Classe 1
Classe 2
Classe 3
Known
novelty
CLASSIFICATION
Works well, 
Nevertheless does not describe the novelty (which variable, …)
Consensus ?…
32 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
MULTIvariate Stationnary
Data   
-
Novelty known(*)
(*) parameters can be ajdusted in the learning
Hidden Markov Model (HMM)
(Viterbi algorithm, 1967)
Andrew J. Viterbi. Error bounds for convolutional codes and an  
asymptotically optimum decoding algorithm. IEEE Transactions on 
Information Theory 13(2):260?269, April 1967.
17
33 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
INTERNAL PROCESS
0
1
2
3
4
5
6
1 101 201 301 401 501 601 701 801 901
Time
S
ta
te
Internal process:
unobservable!
Critical zone
Functionning zone
Alarm zone
Φ is finite and identified with E = {1,2,…,k} 
via the one-to-one map X, from Φ to E.
Write Xn = X(ϕn ) the sequence of internal
states. 
We assume that (Xn) is an homogeneous
Markov chain with known para-meters
and E as state space.
X
In this example : Yn isN(mXn, 0.4) distributed
where (m1, m2, m3, m4, m5) = (1, 1.5, 2, 2.5, 3)
Here : synthetic case :
+ random functionÆ external process
Exemple (1) internal process
34 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
EXTERNAL PROCESS
0
1
2
3
4
5
6
1 101 201 301 401 501 601 701 801 901
Time
M
ea
su
re
s
External process:
measurable
Write Yn the external state of
the system measured at
time tn. 
• Conditional on (Xn), the Yn’s
are independent;
• Yn depends on (Xn), only
thought Xn.
Y
Yn
Exemple (1) external process
uni or multivariate
18
35 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Exemple (1) of internal/external processes
INTERNAL PROCESS
0
1
2
3
4
5
6
1 101 201 301 401 501 601 701 801 901
Time
S
ta
te
EXTERNAL PROCESS
0
1
2
3
4
5
6
1 101 201 301 401 501 601 701 801 901
Time
M
ea
su
re
s
PROBLEM: given the external process (blue),
how to detect the entry of the internal process (red) in the alarm zone? 
External state:
measurable
Internal process:
unobservable!
Critical zone
Functionning zone
Alarm zone
We should alarm at this stage
Internal process
Y signal
Viterbi result (analysis)
?
36 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
The Viterbi algorithm as a solution
x1,…, xn-1
► Assume that at time tn we know for all x in E:
Vn(x) =    max   P(X1=x1,…,Xn-1=xn-1,Xn=x | Y1,…,Yn)
► Update tn → tn+1 (induction):
Vn+1(x) =   f(Yn+1 | ϕx)  × max   Vn(u) × p(u,x)
► At time tn+1 the most likely state is xn+1 = arg max Vn+1(x), 
then send an alarm if xn+1 belongs to the alarm set Φ2 . 
x∈E
known density of Yn+1 given Xn+1 = x
known transition probability
u∈E
Ynmay be seen as a random function of Xn
19
37 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Time
YnYn-1
Learning model
Yn depends only on Yn-1 
(via the probabities given in the matrix model) 
Æ suitable in the Data Stream context
most likely state ?
38 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Exemple (1): shift of the mean
0 100 200 300 400 500 600 700 800 900 1000
0
1
2
3
4
5
6
Viterbi results perfectly agree with the Internal process
0.995  0.005   0          0         0
0         0.995   0.005   0         0
0         0          0.995   0.005  0
0         0          0          0.995  0.005
0         0          0          0         1
P =
Alarm
20
39 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
Example (2): change in scale
0 100 200 300 400 500 600 700 800 900 1000
0
1
2
3
4
5
6
0 100 200 300 400 500 600 700 800 900 1000
0
1
2
3
4
5
6
Same transition matric P as for example 1, 
Yn is N(3, σXn)  distributed
where (σ1, σ2, σ3, σ4, σ5) = (0.1, 0.3, 0.5, 0.8, 1).
Internal process Viterbi results
If only the scale changed,
the novelty is detected with a delay
40 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
HMM, discussion
Values of the model parameters not need to be perfectly known
can be estimated from learning data via (e.g.) maximum likelihood
techniques.
HMM can be seen as dynamic mixture models, 
it includes the iid case (all the lines of P are equal ⇒ Y1,Y2,… are iid)
for which the Viterbi algorithm is useless
For the iid case we have just to estimate at tn: P(ϕn ∈ Φ2 | Yn) 
(classification method based on mixture model by EM-type
algorithms: Celeux, Diebolt, Govaert,…).
NB : Some LAN (Local Asymptotic Normality) methods available to 
detect small changes in parameters (Basseville, Beneveniste, 
Tromp,…).
21
41 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.41 -
CONCLUSION
42 -Caserta, Valois, Blondeau, Dossou Gbete, Bordes.
=> SELECT THE METHOD SUITABLE FOR YOUR WORKFLOW :
• Data Æ Stationnary or not ? 
Uni or multivariate ?
Characteristics of variables, etc
• TaskÆ Novelty previously described or not ?
= Some basic methods work very well in case of basic problem
= More sophiscated methods are needed :
to obtain a better signal/noise ratio,
or in case of more complex (e.g. multivariate) situations
=> SELECT THE METHOD SUITABLE FOR YOUR ORKFLO  :
• Data Stationnary or not ? 
Uni or multivariate ?
Characteristics of variables, etc
• Task Novelty previously described or not ?
= Some basic methods work very well in case of basic problem
= More sophiscated methods are needed :
to obtain a better signal/noise ratio,
or in case of more complex (e.g. multivariate) situations
Our paper does not examplify two important points :
1/  DATA PREPROCESSING CAN BE USEFUL : 
= avoid false alarm and no-detections
2/ GRAPHIC TOOLS FOR DISPLAYING THE ALARM
(Cleveland, Tukey… Heiberger & Holland 2004…)
