Analyse d’images multispectrales par diagonalisation 
simultanée de matrices de covariances. 
 
Philippe Courcoux *, Marie-Françoise Devaux **, Michel Séménou * 
 
* ENITIAA / INRA Unité de Sensométrie et Chimiométrie 
Domaine de la Géraudière BP 82225 44322 Nantes  France 
courcoux@enitiaa-nantes.fr 
 
** INRA URPOI  
Domaine de la Géraudière BP 82225 44322 Nantes  France 
 
 
Résumé. L’analyse conjointe d’un ensemble d’images multispectrales peut 
être présentée comme un problème de diagonalisation simultanée des matrices 
de variances associées. L’application d’un algorithme de décomposition 
simultanée d’un ensemble de matrices définies positives permet l’extraction 
des structures communes à une collection d’images multispectrales d’objets 
différents. La méthode est illustrée par l’analyse d’une séquence d’images de 
grains de céréales. Des images de microscopie en fluorescence de cinq variétés 
de blé et d’orge ont été acquises dans 19 conditions spectrales. L’analyse 
permet de mettre en relief les comportements communs de fluorescence. 
 
1 Introduction 
 
Une image multivariée est un ensemble d’images du même objet ou de la même scène 
prises dans des conditions différentes. Dans le cas de l’imagerie multispectrale, les 
conditions d’acquisition varient en fonction de la longueur d’onde. Une image multivariée 
est donc un objet multi-voies et peut être analysée comme un cube d’images ou comme une 
image de vecteurs de pixels. De nombreuses techniques d’analyse multivariée ont été 
appliquées sur ce type de structure avec des objectifs divers : analyse exploratoire, 
segmentation d’images, reconnaissance de formes ou calibration d’instruments de mesure. 
En particulier, l’Analyse en Composantes Principales a été largement employée pour 
l’interprétation d’images multivariées. Des techniques de régression (comme la régression en 
composantes principales ou la régression PLS) peuvent aussi être appliquées sur ce type de 
données afin de mettre en relation les structures extraites des images avec des informations 
externes. 
Ce papier traite de l’analyse simultanée de plusieurs images multivariées. On suppose 
que l’on possède un ensemble d’images multispectrales d’objets différents dont on souhaite 
faire une analyse commune. L’objectif premier est donc d’extraire l’information commune 
aux images 3-voies des différents objets ou textures. Dans le même esprit qu’en analyse 
multivariée, l’utilisateur souhaite résumer la structure de données en un nombre restreint de 
variables latentes afin de mettre en évidence la partie commune à cet ensemble multivoies. 
Dans l’application qui sera présentée, nous sommes intéressés par la mise en évidence 
des tissus cellulaires communs à différents grains de céréales par microscopie. Une technique 
d’étude de ces images multivariées consiste à analyser séparément chacune des images par 
Analyse d’images multispectrales par diagonalisation simultanée de matrices de covariances. 
RNTI - 1 
Analyse en Composantes Principales (Esbensen et al., 1989, Bharati et al., 1998). Le 
problème est alors de mettre en relation les composantes extraites indépendamment de 
chacune des images afin décrire la structure commune à ces différentes céréales. On 
préfèrera utiliser des techniques d’analyse de données multi-tableaux (multi-way data 
analysis) faisant référence à une famille de techniques statistiques multidimensionnelles 
permettant l’analyse simultanée d’un ensemble de matrices. Une approche générale a été 
donnée par Tucker (1966) : une extension de l’Analyse en Composantes Principales permet 
d’analyser directement un cube de données. L’algorithme Parafac (Parallel Factors Analysis) 
est communément mis en oeuvre pour estimer les paramètres d’un modèle de Tucker par 
moindres carrés alternés mais suppose que tous les modes sont communs à tous les objets à 
étudier, ce qui n’est pas nécessairement le cas avec les images multispectrales : les pixels ne 
sont  en effet pas nécessairement homo logues d’une image à l’autre. 
 
2 Analyse d’images multivariées 
 
2.1 Analyse en Composantes Principales d’une image multispectrale 
 
L’Analyse en Composantes Principales (ACP) d’un cube de taille (I x J  x M) constitué de  
M images (I x J) conduit à sa décomposition en composantes principales Ta et facteurs 
principaux pa. Avec les notations trois -voies usuelles, la décomposition d’un cube X est la 
suivante  
EpTX +=å
=
Ä
A
a
aa
1
 
où E est le résidu d’une ACP de rang A de X et Ä désigne le produit de Kronecker. 
 
 
 
Les matrices composantes principales Ta peuvent être interprétées comme des images et 
sont ordonnées en fonction d’une quantité décroissante d’inertie globale expliquée. 
Cette technique est équivalente à une ACP du tableau “déplié” X dérivé de X. Chaque 
ligne de la matrice X correspond à un des (I x J) pixels des images tandis qu’une de ses 
colonnes correspond à une des M variables d’origine (conditions spectrales par exemple). 
Les composantes principales ta issus d’une ACP de X correspondent alors au dépliage 
des matrices Ta précédentes. 
M)J(IMJI
A
a
dépliage
´´´
+=¾®¾ å
=
EptXX 'aa
1
 
 
 
Courcoux et al. 
RNTI - 1 
 
 
Les paramètres de ce modèle sont le plus souvent obtenus (Geladi et al., 1989) par 
décomposition en valeurs singulières de la matrice X' X afin de calculer les facteurs 
principaux pa :  
'' PPXXV L==  
Cette décomposition conduit à l’estimation de facteurs orthonormés P et de la matrice 
diagonale des valeurs propres L . La reconstitution des composantes principales est ensuite 
réalisée en utilisant la formule 'PXT= .  
 
 
2.2 Analyse d’un ensemble d’images multispectrales 
 
En généralisant l’analyse précédente, l’étude d’un ensemble d’images multivariées peut 
être vue comme la diagonalisation simultanée des matrices de covariances associées. 
L’objectif de ce traitement est d’extraire les structures communes dans la collection d’images 
multivariées de différents objets. 
On suppose l’existence de facteurs principaux communs aux différentes scènes analysées, 
mais avec des poids éventuellement différents. Ainsi, si on note X(k) k=1..K  le tableau déplié 
issu du bloc image k , le modèle est 
å
=
===
A
a
aaa
k(k)(k)(k)(k)
1
')( ppPPXXV ' lL
'
 
où P est orthonormal et les matrices L(k) sont diagonales. 
Les vecteurs de P sont interprétés comme les facteurs communs aux tableaux X(k). Les 
termes diagonaux de la matrice L (k) sont notés la
(k) et reflètent les poids spécifiques des 
dimensions latentes successives dans les images de la scène k . 
Ce modèle a été appelé Analyse en Composantes Communes par Flury et peut être 
considéré comme une forme de généralisation de l’ACP à plusieurs ensembles d’individus 
ou à un ensemble de tableaux. L’hypothèse principale est que les facteurs principaux sont 
identiques dans tous les groupes mais que les variances des composantes principales 
Analyse d’images multispectrales par diagonalisation simultanée de matrices de covariances. 
RNTI - 1 
associées peuvent être spécifiques à chacun de ces groupes. Ce modèle peut donc être 
considéré comme une décomposition simultanée d’un ensemble de matrices de covariances. 
Flury et al. (1986) ont proposé une méthode pour l’estimation par maximum de 
vraisemblance des facteurs communs et des poids spécifiques. Ils montrent que la 
maximisation de la fonction de vraisemblance est équivalente à la minimisation de la 
quantité suivante 
Õ
=
=F
K
k
(k)
(k)
1 P)Vdet(P
P))Vdet(diag(P(P)
'
'
 
Ce critère est d’autant plus petit que les matrices de covariance V(k) peuvent être 
diagonalisées simultanément. La valeur minimale de 1 est atteinte si ces matrices admettent 
les mêmes vecteurs propres (en l’occurrence les colonnes de P). Les termes non-diagonaux 
de P V(k) P’ sont alors tous nuls. 
La technique d’estimation de P est une généralisation de la méthode de Jacobi pour le 
calcul des valeurs singulières d’une matrice symétrique. 
Pham (2001) a étudié le même modèle en relaxant certaines contraintes, notamment 
l’orthogonalité des composantes communes. Dans le cas de l’analyse d’images, cette 
orthogonalité favorise l’interprétation successive des solutions et la solution de Flury semble 
préférable. 
Le problème de la diagonalisation de matrices symétriques a été étudié en vue de la 
détermination de rotations varimax (ten Berge, 1984 ; ten Berge et al., 1988) ou de la 
recherche de solutions en positionnement multidimensionnel (Caroll et al., 1970 ; De Leeuw 
et al., 1978). Les méthodes développées utilisent en général une solution de type moindres 
carrés.  
Une autre formulation du modèle d’analyse du cube de données présenté est Parafac 
(Parallel factor Analysis). Cette technique consiste en une décomposition d’un tableau multi-
voies (Kroonenberg, 1983). L’analyse porte alors sur les tableaux X(k) plutôt que sur les 
matrices de variances V(k) associées. Les algorithmes d’estimation sont basés sur des 
moindres carrés alternés et supposent que les différents tableaux traités ont les mêmes 
dimensions. Dans le contexte du traitement d’images multispectrales, les différentes images 
n’étant pas nécessairement de même taille, cette technique ne peut pas être mise en oeuvre 
sans modification. 
 
 
3 Application 
 
3.1 Echantillons et prise d’images 
 
Des grains issus de trois variétés de blé (Recital, Soissons, Market) et deux variétés 
d’orge (Clarine and Prisma) ont été analysés. Des images de la fluorescence naturelle des 
échantillons ont été acquis es à l’aide d’un microscope confocal à balayage laser (Zeiss LSM 
410). Les échantillons sont excités par rayonnement laser de longueurs d’onde suivantes : 
364 nm (ultraviolet), 488 nm (laser bleu), 543 nm (laser vert) and 633 nm (laser rouge). 
L’émission de lumière est sélectionnée à l’aide de filtres Long Pass (qui recueillent la 
fluorescence au dessus d’une certaine longueur d’onde) ou Band Pass (qui recueillent la 
Courcoux et al. 
RNTI - 1 
fluorescence entre deux longueurs d’onde données). En utilisant 9 filtres différents, le 
microscope peut collecter une séquence de 19 images par échantillon. 
Chaque coupe de grain de céréale a été observée à deux grossissements différents (x10 et 
x40). On obtient des images de taille 512x512 en noir et blanc codant la fluorescence sur 256 
niveaux de gris. 
 
 x10 x40 
Blé 
Market 
  
Blé 
Récital 
  
Blé 
Soissons 
  
Orge 
Clarine 
  
Orge 
Prisma 
  
 
FIG. 1 : PARTIE DE LA COLLECTION D’IMAGES 
 
Analyse d’images multispectrales par diagonalisation simultanée de matrices de covariances. 
RNTI - 1 
Les dimensions des données récoltées sont donc 5 grains x 2 grossissements x 512 lignes 
x 512 colonnes x 19 conditions de fluorescence.  
La Figure 1 présente l’image de fluorescence acquise dans une certaine condition 
d’excitation et d’émission pour chacune des variétés et chacun des deux grossissements 
choisis. 
 
 
 
3.2 Traitement des images multivariées 
 
La décomposition simultanée des 10 (5 variétés x 2 grossissements) matrices de 
covariance de taille (19 x 19) issues de ces images permet de révéler les structures 
communes aux différents grains étudiés. Les tissus mis en évidence par une dimension 
commune peuvent être considérés comme ayant des comportements de fluorescence proches 
et possédant donc des caractéristiques histologiques voisines. 
La décomposition de l’inertie des matrices X(k) sur les premières dimensions (Table 1) 
montre clairement l’importance des deux premières variables latentes dans la structure de 
covariance des images multivariées. 
 
 
 dim 1 dim 2 dim 3 
Blé Market 
(x10) 
0.80 0.13 0.04 
Blé Market 
(x40) 
0.77 0.19 0.01 
Blé Récital 
(x10) 
0.79 0.16 0.02 
Blé Récital 
(x40) 
0.74 0.23 0.00 
Blé Soissons 
(x10) 
0.79 0.16 0.02 
Blé Soissons 
(x40) 
0.72 0.25 0.01 
Orge Clarine 
(x10) 
0.81 0.14 0.02 
Orge Clarine 
(x40) 
0.73 0.22 0.01 
Orge Prisma 
(x10) 
0.83 0.12 0.02 
Orge Prisma 
(x40) 
0.84 0.13 0.01 
 
TAB. 1 : DECOMPOSITION DE L’INERTIE DES 10 IMAGES 
(EN POURCENTAGE) 
 
 
Courcoux et al. 
RNTI - 1 
 
On remarque d’autre part que les deux grossissements ne se comportent pas strictement 
de la même manière  : la deuxième dimension a un poids toujours plus important pour les 
images acquises au grossissement x40 que pour les images relatives au grossissement x10. 
Le phénomène inverse est généralement observé pour les première et trois ième dimensions 
(hormis pour l’orge Prisma). Ceci montre que le grossissement choisi a tendance à accentuer 
la mise en évidence de certains comportements de fluorescence. 
La visualisation des images composantes principales (Figure 2) permet d’interpréter le 
comportement de fluorescence commun aux différentes images et trouve une interprétation 
histologique : la première dimension extrait la couche de péricarpe alors que la deuxième 
montre la couche à aleurone. 
 
 
 
 
 
 
 dimension 1 dimension 2 
 x10 x40 x10 x40 
Blé 
Market 
    
Blé 
Récital 
    
Blé 
Soissons 
    
Orge 
Clarine 
    
Orge 
Prisma 
    
 
FIG. 2 :IMAGES DES COMPOSANTES COMMUNES. 
 
Analyse d’images multispectrales par diagonalisation simultanée de matrices de covariances. 
RNTI - 1 
 
 
 
4 Conclusion 
 
L’intérêt de cette méthode apparaît clairement quand l’objectif est de mettre en évidence 
des dimensions communes à un ensemble d’images, grâce à l’étude des covariances entre les 
conditions spectrales d’acquisition. Cela suppose donc à priori une homogénéité des objets 
ou scènes étudiées. L’évolution dans le temps d’un objet peut être étudiée par exemple avec 
efficacité en utilisant la technique décrite dans cet article. 
Dans certains cas, l’utilisateur est intéressé non seulement par la mise en évidence des 
structures communes mais également par la discrimination des objets étudiés. Une approche 
complémentaire pouvant alors être employée consisterait à identifier simultanément des 
groupes d’objets homogènes et à estimer la structure commune à ces différents ensembles. 
Cela permettrait alors d’effectuer une classification des images multispectrales et d’en 
extraire les caractéristiques qui les segmentent. Le développement d’une approche 
classification en classes latentes du modèle présenté ici fait partie des perspectives de ce 
travail. 
 
 
Références 
 
Bharati M.H., MacGregor J.F.(1998), Multivariate Image Analysis for Real-Time Process, 
Monitoring and Control Ind. Eng. Chem. Res., 37, p. 4715-4724 
Caroll J.D., Chang J.J.(1970), Analysis of individual differences in multidimensional scaling 
via an N-way generalization of 'Eckart-Young' decomposition, Psychometrika, 40, p. 33-
51 
Courcoux P., Devaux M.F., Bouchet B.(2002), Simultaneous decomposition of multivariate 
images using three-way data analysis. Application to the comparison of cereal grains by 
confocal laser scanning microscopy, Chemometrics and Intelligent Laboratory Systems , 
62, p. 103-113. 
De Leeuw J., Pruzansky S.(1978), A new computational method to fit the weighted euclidan 
model, Psychometrika , 43, 4, p. 479-490. 
Esbensen K., Geladi P.(1989), Strategy of Multivariate Analysis (MIA), Chemometrics and 
Intelligent Laboratory Systems , 7, p. 67-86. 
Flury B.(1988), Common Principal Components and Related Multivariate Models, New-
York, John Wiley and Sons, 1988. 
Flury B., Gautschi W.(1986), An algorithm for simultaneous orthogonal transformation of 
several positive definite symmetric matrices to nearly diagonal form, SIAM Journal on 
Scientific and Statistical Computing, 7, p. 169-184. 
Geladi P., Isaksson H., Lindqvist L., Wold S., Esbensen K.(1989), Principal Component 
Analysis of Multivariate Images, Chemometrics and Intelligent Laboratory Systems , 5, p. 
209-220. 
Kroonenberg P.M.(1983), Three-mode Principal Component Analysis, Leiden, DSWO Press, 
1983. 
Courcoux et al. 
RNTI - 1 
Pham D.T.(2001), Joint approximate diagonalization of positive definite hermitian matrices, 
SIAM Journal of Matrix Analysis Applications, 22, 4, p. 1136-1152. 
ten Berge J.M.F.(1984), A joint treatment of varimax rotation and the problem of 
diagonalizing symmetric matrices simultaneously in the least squares sense, 
Psychometrika, 49, 3, p. 347-358. 
ten Berge J.M.F., Knol D.L., Kiers H.A.L. (1988), A treatment of the orthomax rotation 
family in terms of diagonalization, and re-examination of a singular value approach to 
varimax rotation, Computational Statistics Quarterly, 3, p. 207-217. 
Tucker L.R. (1966) Some mathematical notes on three-mode factor analysis, Psychometrika, 
31, p. 279-311. 
 
