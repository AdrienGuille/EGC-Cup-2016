Analyse multigraduelle OLAP 
Gilles Hubert, Olivier Teste 
UniversitÃ© de Toulouse â€“ IRIT (UMR 5505) 
118, Route de Narbonne â€“ 31062 Toulouse cedex 9 (France) 
{Gilles.Hubert, Olivier.Teste}@irit.fr 
RÃ©sumÃ©. Les systÃ¨mes dÃ©cisionnels reposent sur des bases de donnÃ©es multi-
dimensionnelles qui offrent un cadre adÃ©quat aux analyses OLAP. Lâ€™article 
prÃ©sente un nouvel opÃ©rateur OLAP nommÃ© Â« BLEND Â» rendant possible des 
analyses multigraduelles. Il s'agit de transformer la structuration multidimen-
sionnelle lors des interrogations pour analyser les mesures selon des niveaux 
de granularitÃ© diffÃ©rents recombinÃ©es comme un mÃªme paramÃ¨tre. Nous me-
nons une Ã©tude des combinaisons valides de l'opÃ©ration dans le contexte des 
hiÃ©rarchies strictes. Enfin, une premiÃ¨re sÃ©rie dâ€™expÃ©rimentations implante 
lâ€™opÃ©ration dans le contexte R-OLAP en montrant le faible coÃ»t de lâ€™opÃ©ration. 
1 Introduction 
Les systÃ¨mes dâ€™aide Ã  la prise de dÃ©cision connaissent un essor important en raison de 
leur capacitÃ© Ã  supporter efficacement les analyses sur les donnÃ©es disponibles dans les orga-
nisations. Ces systÃ¨mes dÃ©cisionnels sont Ã©laborÃ©s Ã  partir du systÃ¨me opÃ©rationnel dâ€™une 
organisation : les donnÃ©es identifiÃ©es comme pertinentes pour les dÃ©cideurs sont extraites, 
transformÃ©es, puis chargÃ©es (Vassiliadis, et al., 2002) dans un espace de stockage appelÃ© 
entrepÃ´t de donnÃ©es (Â« data warehouse Â»). Afin dâ€™amÃ©liorer lâ€™interrogation et lâ€™analyse de 
ces donnÃ©es entreposÃ©es, des techniques dâ€™organisation des donnÃ©es spÃ©cifiques ont Ã©tÃ© dÃ©ve-
loppÃ©es (Kimball, 1996) reposant sur des bases de donnÃ©es multidimensionnelles (BDM). Ce 
type de modÃ©lisation considÃ¨re la donnÃ©e Ã  analyser comme un point dans un espace Ã  plu-
sieurs dimensions, formant ainsi un cube de donnÃ©es (Gray, et al., 1996). Les dÃ©cideurs qui 
utilisent ces systÃ¨mes visualisent un extrait des cubes de donnÃ©es, gÃ©nÃ©ralement une tranche 
Ã  deux dimensions dâ€™un cube. A partir de cette structure, appelÃ©e table multidimensionnelle 
(TM) (Gyssens et Lakshmanan, 1997), le dÃ©cideur peut interagir au travers dâ€™opÃ©rations de 
manipulation. Les opÃ©rations les plus emblÃ©matiques sont les forages qui consistent Ã  modi-
fier la graduation dâ€™un axe dâ€™analyse (niveaux de granularitÃ©) et les opÃ©rations de rotation qui 
consistent Ã  changer de tranche de cube. On parle dâ€™analyse en ligne ou encore de processus 
OLAP (Â« On-Line Analytic Processing Â») (Ravat, et al., 2008). 
Cet environnement offre un cadre adÃ©quat aux analyses des dÃ©cideurs, cependant la struc-
ture imposÃ©e peut sâ€™avÃ©rer imparfaite ou devenir obsolÃ¨te. ConsidÃ©rons des montants de 
ventes analysÃ©s en fonction de clients franÃ§ais et de clients amÃ©ricains. Dans ce cadre, un 
dÃ©cideur peut vouloir utiliser la graduation en fonction du pays pour les clients franÃ§ais tan-
dis quâ€™il souhaite utiliser simultanÃ©ment une graduation diffÃ©rente, par exemple les Ã©tats 
amÃ©ricains pour les clients des Ã‰tats-Unis. En effet, pour certaines analyses, il est nÃ©cessaire 
Analyse multigraduelle OLAP 
de comparer un pays tel que la France avec des entitÃ©s gÃ©ographiques diffÃ©rentes comme les 
Ã©tats amÃ©ricains afin de comparer des informations Ã©quivalentes en superficie, en taille de 
population, etc. Ce type de manipulation est difficile Ã  mettre en Å“uvre voire impossible 
avec les systÃ¨mes actuels. Lâ€™objectif de cet article est de proposer une solution permettant 
ces manipulations qualifiÃ©es de multigraduelles. 
1.1 Ã‰tat de lâ€™art 
Il existe principalement deux approches pour la modÃ©lisation des BDM : une approche 
reposant sur la mÃ©taphore du cube de donnÃ©es suivant laquelle la BDM est reprÃ©sentÃ©e par 
des cubes, et une approche dite de modÃ©lisation multidimensionnelle oÃ¹ la BDM est dÃ©crite 
par un schÃ©ma en Ã©toile ou en constellation (Kimball 1996). Plusieurs travaux de synthÃ¨ses 
du domaine (Chaudhuri et Dayal, 1997), (Vassiliadis et Sellis, 1999) et Ã©tudes comparatives 
(AbellÃ³, et al., 2006), (Ravat, et al., 2008) sont disponibles. 
Lors de manipulation OLAP, un des premiers travaux Ã©tend lâ€™opÃ©ration dâ€™agrÃ©gation dans 
le contexte des manipulations OLAP (Gray, et al., 1996). Un grand nombre dâ€™opÃ©rations ont 
Ã©tÃ© dÃ©finies, cependant par manque de consensus sur un modÃ¨le de rÃ©fÃ©rence, les proposi-
tions dâ€™opÃ©rations OLAP nâ€™ont toujours pas Ã©tÃ© clairement identifiÃ©es et dÃ©finies au sein 
dâ€™une algÃ¨bre Ã  lâ€™instar de lâ€™approche relationnelle. Une Ã©tude comparative des nombreuses 
propositions existantes est disponible dans (Romero et AbellÃ³, 2007). 
A notre connaissance aucune proposition ne permet de rÃ©pondre Ã  notre problÃ©matique. 
Les solutions les plus proches proposent des mÃ©canismes visant Ã  personnaliser une BDM en 
transformant ses valeurs et ses structures. Dans (Espil et Vaisman, 2001) le langage Ã  base de 
rÃ¨gles IRAH est introduit pour permettre aux dÃ©cideurs de rÃ©organiser les regroupements des 
valeurs entre deux graduations. Cette approche ne permet pas de transformer les structures 
hiÃ©rarchiques des graduations initialement mises en place dans la BDM. Plus rÃ©cemment, 
(Favre, et al., 2007) ont introduit un mÃ©canisme Ã  base de rÃ¨gles Â« Si-Alors Â» afin dâ€™intÃ©grer 
des connaissances utilisateurs pour faire Ã©voluer le schÃ©ma de la BDM. Ce mÃ©canisme per-
met de maniÃ¨re personnalisÃ©e dâ€™ajouter de nouvelles graduations. Bien que ces solutions 
permettent une certaine adaptation de la BDM, elles se heurtent Ã  deux problÃ¨mes : premiÃ¨-
rement, le processus de transformation est dÃ©licat et fastidieux car reposant sur des dÃ©fini-
tions de rÃ¨gles exprimÃ©es par le dÃ©cideur, et deuxiÃ¨mement, la cohÃ©rence et la confiance aux 
donnÃ©es dÃ©cisionnelles entreposÃ©es ne sont plus garanties. Le fait dâ€™introduire des moyens 
directs dâ€™accÃ¨s en modification des valeurs rend inopÃ©rant les processus de nettoyage et de 
consolidation habituels. 
Dâ€™autres travaux dans le contexte de lâ€™Ã©volution des BDM ont proposÃ© des opÃ©rations de 
transformation des hiÃ©rarchies initialement modÃ©lisÃ©es (Blaschka, et al., 1999) (Hurtado, et 
al., 1999) (Eder, et al., 2003). Dans (Blaschka, et al., 1999), une opÃ©ration dâ€™insertion dâ€™un 
nouveau paramÃ¨tre est prÃ©sentÃ©e. Lâ€™opÃ©ration Â« Relate Levels Â», dÃ©finie dans (Hurtado, et 
al., 1999), permet de transformer lâ€™organisation des paramÃ¨tres des hiÃ©rarchies. Dâ€™autres 
opÃ©rations de transformation (Â« Split Â», â€¦) portant sur les valeurs contenues dans les para-
mÃ¨tres sont dÃ©crites dans (Eder, et al., 2003). Ces travaux offrent un cadre permettant 
lâ€™Ã©volution des hiÃ©rarchies, mais ne correspond pas rÃ©ellement Ã  des transformations multi-
graduelles. Ces opÃ©rations peuvent Ãªtre dÃ©tournÃ©es pour transformer la BDM. Cependant, 
notre objectif est diffÃ©rent puisquâ€™il vise Ã  permettre de rÃ©organiser les regroupements des 
valeurs entre deux graduations, et ceci, lors du processus dâ€™analyse, sans impacter physique-
ment les donnÃ©es stockÃ©es dans la BDM. 
G. Hubert et O. Teste 
   
1.2 Contributions et organisation 
La contribution essentielle de cet article est la proposition dâ€™une nouvelle manipulation 
dans les BDM facilitant les analyses multigraduelles. Une analyse multigraduelle combine 
une mÃªme mesure analysÃ©e en fonction de donnÃ©es issues de plusieurs paramÃ¨tres : par 
exemple, nous rendons possibles lâ€™analyse de superficies agricoles en fonction de valeurs 
gÃ©ographiques de niveaux diffÃ©rents telles que les superficies des Ã‰tats-Unis et de lâ€™Europe. 
Nous Ã©tendons lâ€™algÃ¨bre OLAP que nous avons dÃ©finie dans le laboratoire (Ravat, et al., 
2008) par lâ€™opÃ©rateur dâ€™analyse multigraduelle Â« BLEND Â». Nous effectuons une Ã©tude des 
diffÃ©rents cas possibles de fonctionnement de lâ€™opÃ©rateur dans le contexte des hiÃ©rarchies 
strictes (Malinowski et Zimanyi, 2006). Nous proposons un fonctionnement par transforma-
tion de la hiÃ©rarchie courante et nous Ã©tablissons les contours de lâ€™opÃ©rateur en identifiant ses 
limites. Enfin, nous expÃ©rimentons lâ€™opÃ©ration dans le contexte de mise en Å“uvre R-OLAP. 
Un avantage de la solution proposÃ©e, est de rendre possible ce type dâ€™analyse au moment 
de la manipulation des donnÃ©es alors quâ€™elle nÃ©cessite dans un contexte classique la rÃ©orga-
nisation complÃ¨te des donnÃ©es et des processus ETL dâ€™alimentation associÃ©s. La phase de 
construction dâ€™une BDM est une tÃ¢che lourde difficilement rÃ©itÃ©rable en fonction de chaque 
besoin dâ€™analyse. Lâ€™application de ces transformations au niveau des analyses sans impacter 
lâ€™organisation rÃ©elle des donnÃ©es, facilite le partage de la BDM. 
La section 2 prÃ©sente le modÃ¨le de reprÃ©sentation conceptuelle dâ€™une BDM que nous 
adoptons. Nous dÃ©finissons un nouvel opÃ©rateur, appelÃ© Â« BLEND Â» dans la section 3. Nous 
montrons les diffÃ©rents cas possibles de manipulations multigraduelles quâ€™il autorise dans le 
contexte de hiÃ©rarchisation stricte des dimensions (Malinowski et Zimanyi, 2006). La sec-
tion 4 dÃ©crit la mise en Å“uvre de lâ€™opÃ©rateur dans le contexte R-OLAP. 
2 ModÃ©lisation et manipulation OLAP 
Cette section introduit les diffÃ©rentes dÃ©finitions des concepts permettant de reprÃ©senter 
les Ã©lÃ©ments dâ€™une BDM (Ravat, et al., 2008). Notre modÃ¨le repose sur une reprÃ©sentation 
des donnÃ©es par une constellation (Kimball 1996) regroupant un ensemble de faits associÃ©s Ã  
des dimensions partagÃ©es ou spÃ©cifiques. 
DÃ©finition 1. Une constellation C est dÃ©finie par (NC, FC, DC, StarC) oÃ¹ NC est le nom de 
la constellation, FC = {F1,â€¦, Fp} est un ensemble de faits, D
C = {D1,â€¦, Dq} est un ensemble 
de dimensions, et StarC : FC2DC 1 est une fonction associant les faits aux dimensions. 
DÃ©finition 2. Une dimension D modÃ©lise un axe dâ€™analyse et se dÃ©finit par (ND, AD, HD, 
ID) oÃ¹ ND est le nom de la dimension, AD = {a1,â€¦, au} âˆª {All, Id} est un ensemble d'attri-
buts, HD = {hD1,â€¦, h
D
v} est un ensemble de hiÃ©rarchies, et I
D = {ID1, I
D
2,â€¦} est l'ensemble 
des instances de D. Les hiÃ©rarchies organisent les attributs dâ€™une dimension, appelÃ©s paramÃ¨-
tres, de la graduation la plus fine jusquâ€™Ã  la graduation la plus gÃ©nÃ©rale. Ainsi une hiÃ©rarchie 
dÃ©finit les chemins de navigation valides sur un axe dâ€™analyse.  
DÃ©finition 3. Une hiÃ©rarchie hDi est un chemin Ã©lÃ©mentaire acyclique partant du paramÃ¨-
tre racine, notÃ© Id, jusquâ€™au paramÃ¨tre extrÃ©mitÃ©, notÃ© All. Elle est dÃ©finie par (NhDi, Param
h-
D
i, Suppl
hD
i) oÃ¹ N
hD
i est le nom de la hiÃ©rarchie, Param
hD
i : PP (PâŠ†A
D) est une fonction 
dÃ©crivant la hiÃ©rarchie des attributs, appelÃ©s paramÃ¨tres de la hiÃ©rarchie, SupplhDi : P2(AD-P)
                                                
1 La notation 2E reprÃ©sente lâ€™ensemble des parties dâ€™un ensemble E.
Analyse multigraduelle OLAP 
est une fonction spÃ©cifiant les attributs faibles qui complÃ¨tent la sÃ©mantique des paramÃ¨tres 
(un ensemble, Ã©ventuellement vide, d'attributs faibles est associÃ© Ã  un paramÃ¨tre). 
DÃ©finition 4. Un fait F reprÃ©sente un ensemble dâ€™indicateurs relatifs Ã  un sujet dâ€™analyse 
et se dÃ©finit par le quadruplet (NF, MF, IF, IStarF) oÃ¹ NF est le nom du fait, MF = {f1(m1),â€¦, 
fw(mw)} est un ensemble de mesures (ou indicateurs) agrÃ©gÃ©es selon une fonction fiâˆˆ{AVG, 
SUM, MAX, MIN, COUNT,â€¦}, IF = {IF1, I
F
2,â€¦} est l'ensemble des instances de F, et IStar
F
est une fonction associant les instances de IF aux instances des dimensions liÃ©es au fait.  
AdossÃ©s au modÃ¨le de reprÃ©sentation, nous dÃ©finissons, dâ€™une part, une structure de vi-
sualisation appelÃ©e TM qui centre l'analyse sur un fait en fonction de deux dimensions sÃ©lec-
tionnÃ©es. Dâ€™autre part, un opÃ©rateur de construction et un ensemble dâ€™opÃ©rateurs de manipu-
lation sont disponibles. Nous ne dÃ©taillons pas dans cet article ces opÃ©rations ; une Ã©tude 
exhaustive est disponible dans (Ravat, et al., 2008). 
FIG. 1 â€“  Exemple dâ€™Ã©toile (constellation Ã  un seul fait) et de TM obtenues par manipulations. 
Exemple 1. Une BDM supportant des analyses sur la rÃ©partition de parcelles OGM dans 
le monde est dÃ©finie au travers dâ€™une constellation formÃ©e dâ€™un fait et de trois dimensions 
(cf. figure 1) ; nous adoptons un formalisme graphique proche de celui proposÃ© par (Golfarel-
li, et al., 1998). Un dÃ©cideur peut alors visualiser le contenu du fait et des dimensions au 
travers dâ€™une TM ; la table T1 prÃ©sentÃ©e affiche la rÃ©partition des superficies par continent et 
par type dâ€™organisme. Par une combinaison dâ€™opÃ©rations, le dÃ©cideur transforme cette T1 
pour visualiser dans T2 les superficies par Ã©tat des pays en fonction des diffÃ©rentes variÃ©tÃ©s 
afin de comparer les variÃ©tÃ©s OGM (GTS-Soja, MaÃ¯s BT176 et Mon 810) aux variÃ©tÃ©s Â« clas-
siques Â». 
3 Lâ€™opÃ©rateur Â« BLEND Â» 
Afin de rÃ©pondre Ã  notre problÃ©matique dâ€™analyse multigraduelle, nous dÃ©finissons une 
opÃ©ration permettant de transformer les paramÃ¨tres des dimensions. Cette opÃ©ration baptisÃ©e 
Â« BLEND Â» sâ€™applique sur les TM de sorte Ã  modifier les entÃªtes des lignes ou des colonnes. 
G. Hubert et O. Teste 
   
3.1 OpÃ©rateur algÃ©brique 
DÃ©finition 5. L'opÃ©ration de transformation multigraduelle dâ€™une TM est dÃ©finie par : 
BLEND(TSRC, D, Psup(ssup), Pinf(sinf), pred ) = TRES
- TSRC = (SSRC, LSRC, CSRC, RSRC) est la TM source Ã  transformer, 
- Dâˆˆ{DLSRC, DCSRC} est lâ€™une des dimensions de la TM TSRC, 
- Psup et Pinf sont des paramÃ¨tres consÃ©cutifs affichÃ©s de la dimension D tels que Psup
est le paramÃ¨tre hiÃ©rarchiquement supÃ©rieur Ã  Pinf, 
- ssupâˆˆ{+,-} et sinfâˆˆ{+,-} sont des estampilles indiquant la conservation (+) ou non (-) 
du paramÃ¨tre associÃ© dans TRES ; lâ€™utilisation des estampilles et leurs diffÃ©rentes 
combinaisons sont Ã©tudiÃ©es de maniÃ¨re exhaustive dans la section suivante (3.2), 
- pred est un prÃ©dicat de sÃ©lection permettant de dÃ©terminer les valeurs issues des pa-
ramÃ¨tres Psup et Pinf pour construire le domaine de dÃ©finition du nouveau paramÃ¨tre 
notÃ© Psup_Pinf dans TRES, 
- TRES est la TM rÃ©sultat. 
Le prÃ©dicat pred sert Ã  calculer les ensembles Esup et Einf, qui regroupent les valeurs issues 
des paramÃ¨tres Psup et Pinf participant Ã  la construction du domaine du nouveau paramÃ¨tre : 
- Esup contient les valeurs de Psup sÃ©lectionnÃ©es par pred, 
- Einf contient les valeurs de Pinf sÃ©lectionnÃ©es par Â¬pred. 
Contrainte 1. Le prÃ©dicat notÃ© pred dans la dÃ©finition de l'opÃ©rateur Â« BLEND Â» est va-
lide si et seulement si Esup âˆ© parent(Einf) = âˆ… avec : 
- parent(Einf) dÃ©signe les valeurs de dom(Psup) liÃ©es Ã  Einf, 
- dom(Psup) dÃ©signe le domaine de dÃ©finition de Psup. 
Par abus de langage, nous dirons que pred doit dÃ©finir deux ensembles de valeurs Â« dis-
joints Â» au regard de lâ€™organisation hiÃ©rarchique. 
Contrainte 2. La composition dâ€™opÃ©rateurs Â« BLEND Â» nâ€™est pas commutative. 
Lâ€™utilisateur doit construire ses manipulations en tenant compte de lâ€™ordre des paramÃ¨tres 
Psup et Pinf, mais Ã©galement de lâ€™ordre des combinaisons des transformations multigraduelles. 
3.2 Cas de transformation 
Lâ€™opÃ©rateur Â« BLEND Â» modifie la hiÃ©rarchie existante en substituant un nouveau para-
mÃ¨tre Ã  lâ€™un des paramÃ¨tres existants (ou les deux) ou en intÃ©grant un nouveau paramÃ¨tre en 
plus des paramÃ¨tres existants. Lâ€™intÃ©rÃªt de lâ€™opÃ©ration rÃ©side dans la transformation de la 
hiÃ©rarchie existante remplaÃ§ant la hiÃ©rarchie initiale considÃ©rÃ©e obsolÃ¨te directement dans la 
TM par lâ€™utilisateur sans imposer une reconstruction de la BDM. 
Lâ€™intÃ©gration du nouveau paramÃ¨tre peut sâ€™effectuer selon quatre scenarii : 
- soit le paramÃ¨tre remplace les deux existants Psup et Pinf (TAB. 1 - a), 
- soit le paramÃ¨tre remplace le paramÃ¨tre Pinf (TAB. 1 - b), 
- soit le paramÃ¨tre remplace le paramÃ¨tre Psup (TAB. 1 - c), 
- soit le paramÃ¨tre sâ€™intercale entre les paramÃ¨tres Psup et Pinf (TAB. 1 - d). 
Les estampilles ajoutÃ©es aux deux paramÃ¨tres Psup et Pinf indiquent le scÃ©nario choisi. 
Lâ€™estampille (-) indique que le paramÃ¨tre ne doit pas apparaÃ®tre dans le rÃ©sultat tandis que 
lâ€™estampille (+) indique le contraire. Ceci permet de transformer deux paramÃ¨tres en crÃ©ant 
un nouveau paramÃ¨tre multigraduel, tout en choisissant de maintenir tout ou partie des possi-
bilitÃ©s de navigations initiales (avec les opÃ©rations de forages). Dans le tableau 1, le scenario 
Analyse multigraduelle OLAP 
(a) fait disparaÃ®tre les possibilitÃ©s de forer sur les pays et les Ã©tats (seul le paramÃ¨tre multi-
graduel reste disponible) tandis que le scÃ©nario (d) maintient les deux paramÃ¨tres initiaux. 
Il est important de noter que nous ne prÃ©sentons ici que les possibilitÃ©s qui maintiennent 
des hiÃ©rarchies strictes (Malinowski et Zimanyi, 2006) dans lesquelles toute valeur du para-
mÃ¨tre infÃ©rieur ne peut Ãªtre liÃ©e quâ€™Ã  une seule valeur du paramÃ¨tre supÃ©rieur. 
TAB. 1 â€“ Quatre possibilitÃ©s de modification de la hiÃ©rarchie. 
Parcelle
Pays-Etat
Continent AmÃ©rique
BrÃ©silIowaMinnesota
Asie
Inde
â€¦ â€¦ â€¦ â€¦ â€¦ â€¦
Esup Einfâˆª
(a) BLEND(TSRC, Geographies, Pays(-), Etat(-), Pays <> â€™Etats-Unisâ€™) 
AmÃ©rique
Etats-Unis BrÃ©sil
IowaMinnesota
Asie
Inde
â€¦ â€¦ â€¦ â€¦ â€¦ â€¦
BrÃ©sil IndePays-Etat
Parcelle
Pays
Continent
Esup Einfâˆª
(b) BLEND(TSRC, Geographies, Pays(+), Etat(-),Pays <> â€™Etats-Unisâ€™) 
Etat
Parcelle
Pays-Etat
Continent AmÃ©rique
IowaMinnesota Goias
Asie
PenjabMaharashtra Rajasthan
â€¦ â€¦ â€¦ â€¦ â€¦ â€¦
IowaMinnesota BrÃ©sil Inde
Esup Einfâˆª
(c) BLEND(TSRC, Geographies, Pays(-), Etat(+),Pays <> â€™Etats-Unisâ€™) 
Etat
Parcelle
Pays
Pays-Etat
Continent AmÃ©rique
Etats-Unis BrÃ©sil
IowaMinnesota Goias
Asie
Inde
PenjabMaharashtra Rajasthan
â€¦ â€¦ â€¦ â€¦ â€¦ â€¦
IowaMinnesota BrÃ©sil Inde
Esup Einfâˆª
(d) BLEND(TSRC, Geographies, Pays(+), Etat(+),Pays <> â€™Etats-Unisâ€™) 
G. Hubert et O. Teste 
   
3.3 PropriÃ©tÃ© de fermeture de lâ€™opÃ©rateur 
La dÃ©finition de lâ€™opÃ©rateur Â« BLEND Â» respecte la propriÃ©tÃ© de fermeture : il sâ€™applique 
sur une TM et produit une nouvelle TM. Cette propriÃ©tÃ© permet lâ€™enchaÃ®nement de plusieurs 
opÃ©rations afin dâ€™opÃ©rer des transformations complexes Ã  partir de lâ€™opÃ©ration Ã©lÃ©mentaire. 
Exemple 2. ConsidÃ©rons une analyse complexe dans laquelle un dÃ©cideur souhaite com-
parer les superficies de cÃ©rÃ©ales entre les Ã©tats amÃ©ricains, un pays tel que le BrÃ©sil et le 
continent asiatique. Cette analyse est multigraduelle sur trois niveaux puisquâ€™elle fait inter-
venir, un continent, un pays, et des Ã©tats amÃ©ricains (subdivisions dâ€™un pays). A partir de la 
TM T2, nous enchaÃ®nons les deux opÃ©rations de transformation multigraduelle suivantes : 
BLEND(BLEND(T2, Geographies, Pays(-), Etat(-), Pays <> â€™Etats-Unisâ€™), Geographies, 
Continent(-), Pays-Etat(-),Continent = â€™Asieâ€™) = T3 
Les figures suivantes illustrent lâ€™enchaÃ®nement des deux opÃ©rations avec les transforma-
tions multigraduelles induites. 
FIG. 2 â€“  Structuration initiale de Geographies dans T2. 
FIG. 3 â€“  Structuration intermÃ©diaire de Geographies aprÃ¨s le premier Â« BLEND Â» figure 2. 
FIG. 4 â€“  Structuration finale de Geographies dans T3 aprÃ¨s le second Â« BLEND Â» figure 3. 
Lâ€™enchaÃ®nement des deux BLEND donne lieu Ã  une transformation multigraduelle des 
donnÃ©es de T2. La table rÃ©sultat T3 est prÃ©sentÃ©e Ã  la figure 5. 
Analyse multigraduelle OLAP 
FIG. 5 â€“  Principe de transformations multigraduelles. 
3.4 Cas particuliers de lâ€™opÃ©rateur 
3.4.1 SÃ©lection vide 
Lâ€™expression du prÃ©dicat pred dans lâ€™opÃ©rateur Â« BLEND Â» peut conduire Ã  une sÃ©lection 
vide de valeurs sur Psup ou Pinf. Si lâ€™ensemble Esup, respectivement Einf, est vide, alors 
lâ€™opÃ©ration reste valide. Ce cas particulier consiste Ã  supprimer le paramÃ¨tre Psup, respecti-
vement Pinf. Notons que ce rÃ©sultat peut sâ€™obtenir par combinaison dâ€™autres opÃ©rateurs de 
lâ€™algÃ¨bre (Ravat, et al., 2008). Par dÃ©finition, le cas oÃ¹ Esup et Einf seraient simultanÃ©ment 
vides ne peut survenir. 
Exemple 3. ConsidÃ©rons une nouvelle opÃ©ration Â« BLEND Â» qui cherche Ã  combiner les 
pays ayant une forte densitÃ© de population (DensitÃ© > 20) avec les Ã©tats de pays dont la densi-
tÃ© est moindre. Lâ€™opÃ©ration suivante est exprimÃ©e. 
BLEND(T3, Geographies, Pays(ssup), Etat(sinf), DensitÃ©>20) avec ssupâˆˆ{+,-} et sinfâˆˆ{+,-}.
Sachant que les Ã‰tats-Unis, le BrÃ©sil et lâ€™Inde ont respectivement les densitÃ©s de 31.15, 
21.60 et 300.24 hab/km2, le prÃ©dicat DensitÃ© > 20 aboutit au calcul des ensembles de valeurs 
suivants : Esup = {â€˜Etats-Unisâ€™, â€˜BrÃ©silâ€™, â€˜Indeâ€™} et Einf = âˆ…. Ce cas particulier oÃ¹ Einf est vide 
revient Ã  conserver tous les pays tout en faisant disparaÃ®tre de lâ€™analyse les Ã©tats associÃ©s. 
3.4.2 ParamÃ¨tre racine 
Lâ€™opÃ©ration Â« BLEND Â» appliquÃ©e Ã  la racine de la dimension, induit la transformation 
multigraduelle de la dimension et le recalcul des valeurs des mesures associÃ©es. En effet, la 
suppression des valeurs du paramÃ¨tre racine nÃ©cessite lâ€™agrÃ©gation des valeurs des mesures 
associÃ©es. Chaque valeur agrÃ©gÃ©e est reliÃ©e Ã  la valeur du paramÃ¨tre supÃ©rieur. 
Exemple 4. ConsidÃ©rons lâ€™opÃ©ration Â« BLEND Â» faisant intervenir le paramÃ¨tre racine 
Parcelle suivant laquelle un dÃ©cideur souhaite comparer les superficies entre les Ã©tats amÃ©ri-
cains et toutes les parcelles dâ€™autres pays. Lâ€™opÃ©ration suivante est exprimÃ©e. 
G. Hubert et O. Teste 
   
BLEND(T3, Geographies, Etat(ssup), Parcelle(sinf), Pays = â€™Etats-Unisâ€™).
Les ensembles Esup={â€˜Minnesotaâ€™, â€˜Iowaâ€™} et Einf={â€˜P3â€™, â€˜P4â€™, â€˜P5â€™, â€˜P6â€™} sont calculÃ©s. 
Dans la TM rÃ©sultat, les valeurs des mesures initialement associÃ©es aux parcelles des 
Ã‰tats-Unis (â€˜P1â€™, â€˜P2â€™ et â€˜P7â€™) sont agrÃ©gÃ©es pour Ãªtre reliÃ©es aux valeurs des Ã©tats sÃ©lection-
nÃ©s dans Esup. La fonction utilisÃ©e est celle spÃ©cifiÃ©e lors de la construction de la TM initiale 
par le constructeur DISPLAY (figure 1). Dans cet exemple, la fonction SUM est utilisÃ©e. Ce 
principe dâ€™utilisation, lors des manipulations suivantes, de la mÃªme fonction dâ€™agrÃ©gat que 
celle utilisÃ©e initialement est identique aux opÃ©rations de forage. Il peut Ãªtre envisagÃ© 
dâ€™Ã©tendre lâ€™opÃ©rateur pour permettre Ã  lâ€™utilisateur de spÃ©cifier une fonction dâ€™agrÃ©gation 
diffÃ©rente de celle utilisÃ©e pour construire la table source. 
4 ExpÃ©rimentation en environnement R-OLAP 
Lâ€™opÃ©ration Â« BLEND Â» est implantÃ©e au sein de lâ€™outil Graphic-OLAP que nous dÃ©ve-
loppons dans notre laboratoire avec le langage Java au dessus du SGBD Oracle. Les princi-
pes de modÃ©lisation et de manipulation des BDM que nous dÃ©finissons sont mis en Å“uvre 
dans un contexte R-OLAP. Lâ€™architecture repose sur un stockage relationnel de donnÃ©es et 
de mÃ©tadonnÃ©es tout en prÃ©sentant diverses interfaces Ã  lâ€™utilisateur. 
La constellation de faits et de dimensions est implantÃ©e sous forme de tables : un ensem-
ble de mÃ©tatables dÃ©crit la structure multidimensionnelle et un ensemble de tables stocke les 
donnÃ©es dÃ©cisionnelles disponibles pour lâ€™analyse. Pour simplifier, notre prÃ©sentation est 
limitÃ©e aux tables de stockage des donnÃ©es dÃ©taillÃ©es ; nous nâ€™abordons pas la problÃ©matique 
dâ€™optimisation par des vues matÃ©rialisÃ©es (Zhuge, et al., 1998) (Kotidis et Roussopoulos, 
1999). Dans ce cadre simplifiÃ©, les interrogations effectuÃ©es par lâ€™utilisateur sont traduites 
par une requÃªte SQL dâ€™extraction sur les tables stockant les donnÃ©es dÃ©cisionnelles. 
Exemple 5. Le schÃ©ma en Ã©toile de la figure 1 est stockÃ© en R-OLAP comme suit : 
DATES(id_dates, moisn, moisl, trimestre, annee, quadriennal) 
ORGANISMES(id_organismes, variete, categorie, typeorganisme) 
GEOGRAPHIES(id_geographies, parcelle, etat, region, pays, densite, continent)
REPARTITION(id_repartition, id_dates#,id_organismes#,id_geographies#, superficie) 
ReconsidÃ©rons les deux opÃ©rations Â« BLEND Â» illustrÃ©es figures 2, 3 et 4. La TM T3 de 
la figure 5 est obtenue Ã  partir du rÃ©sultat de requÃªtes dâ€™extraction gÃ©nÃ©rÃ©es par Graphic-
OLAP. Le tableau suivant montre les requÃªtes SQL gÃ©nÃ©rÃ©es pour chaque opÃ©ration : 
TAB. 2 â€“ Traduction SQL de lâ€™opÃ©ration BLEND. 
	
	
	
	







	
	

 	

	
 

!

"

#$%
&'
(


$)%

$)%	
















%	


*	
+

	


$)%	
%	
	
+














	






,,























$)%	
%	
	
+













	







,,



%	
	
+-

#$%
&'
(


$)%

$)%	

















%

%**	
+

	




$)%	
%	
	
+
















	




%

,!,


























$)%	
%	
	
+















	





%

,!,



%	
+-

Analyse multigraduelle OLAP 
Nous avons menÃ© des expÃ©rimentations afin dâ€™Ã©valuer le coÃ»t de lâ€™opÃ©ration. Notre objec-
tif est dâ€™analyser le coÃ»t que reprÃ©sente cette opÃ©ration calculÃ©e dynamiquement lorsque 
lâ€™utilisateur en exprime le besoin. La comparaison a consistÃ© Ã  observer le coÃ»t thÃ©orique du 
calcul de requÃªtes portant sur ces relations de base. Nous avons comparÃ© deux requÃªtes : 
- une requÃªte effectuant dynamiquement la transformation multigraduelle (sÃ©rie 1), 
- une requÃªte utilisant un attribut stockant le rÃ©sultat de la transformation multigra-
duelle simulant lâ€™utilisation dâ€™une BDM modÃ©lisÃ©e en fonction du besoin Ã©quivalent 
Ã  la transformation multigraduelle (sÃ©rie 2). 
Nous avons gÃ©nÃ©rÃ© des enregistrements dans les relations de notre BDM, complÃ©tÃ©es par 
des index multiples sur les clÃ©s Ã©trangÃ¨res : |ORGANISMES| = 250, 10 â‰¤ |GEOGRAPHIES| 
â‰¤ 100, |REPARTITION| = |ORGANISMES| x |GEOGRAPHIES|. Les valeurs des enregis-
trements ont Ã©tÃ© gÃ©nÃ©rÃ©es alÃ©atoirement en veillant Ã  ce que les deux sous-ensembles Esup et 
Einf soient de tailles homogÃ¨nes. 
0
10
20
30
40
10 20 30 40 50 60 70 80 90 100
Taille
C
o
Ã»
t
SÃ©rie1 SÃ©rie2
0
5
10
15
20
10 20 30 40 50 60 70 80 90 100
Taille
P
o
u
rc
en
t
 (a) (b) 
FIG. 6 â€“  RÃ©sultat dâ€™expÃ©rimentation sur le coÃ»t de lâ€™opÃ©rateur BLEND. 
Les valeurs du coÃ»t correspondent au coÃ»t thÃ©orique calculÃ© par le SGBD (coÃ»t fourni par 
le Â« explain plan Â» dâ€™Oracle Server Application 11g). En effet, notre expÃ©rimentation vise 
simplement Ã  Ã©tudier le surcoÃ»t engendrÃ© par un calcul du BLEND. La taille correspond aux 
variations du nombre de n-uplets dans GEOGRAPHIES (10 Ã  100) et REPARTITION 
(250x10 Ã  250x100) ; la taille de la relation ORGANISMES reste constante Ã  250 n-uplets. 
La figure 6(a) compare les deux requÃªtes. Le calcul dynamique (sÃ©rie 1) est Ã©videmment 
plus couteux que lâ€™utilisation de la transformation prÃ©alablement stockÃ©e (sÃ©rie 2), cepen-
dant, ce coÃ»t nâ€™est pas trÃ¨s important (entre 18% et 2%). Ce rÃ©sultat est dâ€™autant plus encou-
rageant que nous montrons sur la figure 6(b) que ce surcoÃ»t tend Ã  diminuer avec 
lâ€™accroissement du nombre dâ€™enregistrements dans la relation transformÃ©e. 
NÃ©anmoins, il convient de poursuivre nos expÃ©rimentations, pour consolider ces premiers 
rÃ©sultats. Nous envisageons plusieurs voies :  
- tester notre opÃ©rateur sur une dimension plus volumineuse en augmentant significa-
tivement les tailles des relations GEOGRAPHIES et REPARTITION, 
- observer si le comportement de lâ€™opÃ©rateur reste stable avec des prÃ©dicats de calcul 
Ã  la marge (lors de cette premiÃ¨re expÃ©rimentation, nous avons utilisÃ© un prÃ©dicat 
aboutissant Ã  une partition de taille homogÃ¨ne entre Esup et Einf) de maniÃ¨re Ã  obtenir 
un Esup disproportionnÃ© par rapport Ã  Einf, ou encore Esup ou Einf vide, 
G. Hubert et O. Teste 
   
- intÃ©grer dans nos scÃ©narii de tests des vues matÃ©rialisÃ©es optimisant le temps de cal-
cul des requÃªtes afin de sâ€™assurer que le coÃ»t de lâ€™opÃ©rateur reste supportable par 
comparaison Ã  un stockage prÃ©-calculÃ©. 
5 Conclusion 
Cet article traite dâ€™un type dâ€™analyses complexes consistant Ã  combiner des paramÃ¨tres de 
niveaux de granularitÃ© diffÃ©rents. Ce type dâ€™analyses dites multigraduelles est difficilement 
rÃ©alisable avec les systÃ¨mes traditionnels puisquâ€™elles nÃ©cessitent dâ€™organiser les donnÃ©es en 
fonction de chaque analyse. Nous introduisons un nouvel opÃ©rateur algÃ©brique pour les ma-
nipulations OLAP, appelÃ© Â« BLEND Â». Nous Ã©tudions les contours de son utilisation sur des 
hiÃ©rarchies strictes. Lâ€™approche permet de transformer une hiÃ©rarchie en maintenant les au-
tres possibilitÃ©s de navigation sur celle-ci. Lâ€™opÃ©rateur proposÃ© est mis en Å“uvre dans le 
contexte R-OLAP au sein du SGBD Oracle, afin dâ€™Ã©tablir la faisabilitÃ© de la proposition. 
A court terme, une premiÃ¨re perspective est de mener une Ã©tude sur les techniques 
dâ€™optimisation possibles de lâ€™opÃ©rateur, notamment en exploitant les treillis de vues matÃ©ria-
lisÃ©es mis en place au sein des BDM. Lâ€™expression de lâ€™opÃ©ration dans notre langage graphi-
que (Ravat, et al., 2007) constitue Ã©galement une extension directe de ces travaux. Nous 
projetons Ã©galement dâ€™Ã©tudier dâ€™autres principes de transformations multigraduelles dans des 
contextes plus complexes tels que celui des hiÃ©rarchies non strictes. 
RÃ©fÃ©rences 
AbellÃ³, A., Samos, J., Saltor, F. (2006). YAM2: a multidimensional conceptual model ex-
tending UML. Information Systems 31(6), pp. 541â€“567. 
Blaschka, M., Sapia, C., HÃ¶fling, G. (1999). On Schema Evolution in Multidimensional 
Databases. Intl. Conf. DaWaKâ€™99, pp. 153-164. 
Chaudhuri, S., Dayal, U.  (1997). An Overview of Data Warehousing and OLAP Technol-
ogy. SIGMOD Record, 26(1), pp. 65-74. 
Eder, J., Koncilia, C., Mitsche, D. (2003). Automatic Detection of Structural Changes in 
Data Warehouses. Intl. Conf. DaWaKâ€™03, pp. 119-128. 
Espil, M. M., Vaisman, A. A. (2001) Efficient Intensional Redefinition of Aggregation Hier-
archies in Multidimensional Databases. Intl. Workshop DOLAPâ€™01. 
Favre, C., Bentayeb, F. Boussaid, O. (2007). Evolution et personnalisation des analyses dans 
les entrepÃ´ts de donnÃ©es : une approche orientÃ©e utilisateur. National Conf. 
INFORSIDâ€™07, Perros-Guirec, France, pp. 308-323. 
Golfarelli, M., Maio, D. Rizzi, S. (1998). Conceptual Design of Data Warehouses from E/R 
Schemes. Intl. Conf. HICSSâ€™98, Vol. 7, pp. 334-343. 
Gray, J., Bosworth, A., Layman, A., Pirahesh, H. (1996). Data Cube: A Relational Aggrega-
tion Operator Generalizing Group-By, Cross-Tab, and Sub-Total. Intl. Conf. ICDEâ€™96, 
pp. 152â€“159. 
Analyse multigraduelle OLAP 
Gyssens, M., Lakshmanan, L. V. S. (1997). A Foundation for Multi-Dimensional Databases. 
Intl. Conf. VLDBâ€™97, pp. 106-115. 
Hurtado, C. A., Mendelzon, A. O., Vaisman A. A. (1999). Maintaining Data Cubes under 
Dimension Updates. Intl. Conf. ICDEâ€™99, pp. 346-355. 
Kimball R. (1996). The Data Warehouse Toolkit: Practical Techniques for Building Dimen-
sional Data Warehouses. John Wiley & Sons, USA (1996) 
Kotidis Y., Roussopoulos, N. (1999). DynaMat: A Dynamic View Management System for 
Data Warehouses. Intl. Conf. SIGMODâ€™99, pp. 371-382. 
Malinowski, E., Zimanyi, E. (2006). Hierarchies in a multidimensional model: From concep-
tual modeling to logical representation. Data and Knowledge Engineering, 59(2), pp. 
348-377. 
Ravat, F., Teste, O., Tournier, R., Zurfluh (2007). Graphical Querying of Multidimensional 
Databases. Intl. Conf. ADBISâ€™07, pp. 298-313 
Ravat, F., Teste, O., Tournier, R., Zurfluh (2008). G.: Algebraic and graphic languages for 
OLAP manipulations. Intl. J. of Data Warehousing and Mining, 4(1), p. 17-46. 
Romero, O., AbellÃ³, A. (2007). On the Need of Reference Algebra for OLAP, Intl. Conf. 
DaWaKâ€™07, pp. 99-110. 
Vassiliadis, P., Sellis, T. K. (1999). A Survey of Logical Models for OLAP Databases. 
SIGMOD Record, 28(4), pp. 64-69. 
Vassiliadis, P., Simitsis, A., Skiadopoulos, S. (2002). Modeling ETL activities as graphs. 
Intl. Conf. DMDWâ€™02, pp. 52-61. 
Zhuge Y., Garcia-Molina, H., Wiener, J.L. (1998). Consistency Algorithms for Multi-Source 
Warehouse View Maintenance. Distributed and Parallel Databases, 6(1), pp. 7-40. 
Summary 
Decisional systems are based on multidimensional databases improving OLAP analyses. 
The paper describes a new OLAP operator named Â« BLEND Â» to perform multigradual 
analyses. The operation transforms multidimensional structures during querying in order to 
analyse measures according to various granularity levels, which are reorganised into a single 
parameter. We study valid combinations of the operation in the context of strict hierarchies. 
First experimentations implement the operation in an R-OLAP framework showing the slight 
cost of this operation. 
