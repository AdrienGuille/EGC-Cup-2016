Re´seaux Baye´siens de Niveau Deux et D-Se´paration
Linda Smail, Jean-Pierre Raoult
Laboratoire d’Analyse et de Mathe´matiques Applique´es (CNRS UMR 8050)
Universite´ de Marne-la-Valle´e
5 boulevard Descartes, Champs sur Marne 77454 Marne-la-Valle´e Cedex 2
linda.smail@univ-mlv.fr, raoult@math.univ-mlv.fr
Re´sume´. Etant donne´ une famille de variables ale´atoires (Xi)i∈I , mu-
nie de la structure de re´seau baye´sien et un sous-ensemble S de I, nous
conside´rons le proble`me de calcul de la loi de la sous-famille (Xa)a∈S
(resp. la loi de (Xb)b∈S¯ , ou` S¯ = I − S, conditionnellement a` (Xa)a∈S).
Nous mettons en e´vidence la possibilite´ de de´composer cette taˆche en plu-
sieurs calculs paralle`les dont chacun est associe´ a` une partie de S (resp.
de S¯) ; ces re´sultats partiels sont ensuite regroupe´s dans un produit. Dans
le cas du calcul de (Xa)a∈S , ceci revient a` la mise en place sur S d’une
structure de re´seau baye´sien de niveau deux.
1 Introduction
Etant donne´ un re´seau baye´sien (Xi)i∈I , nous nous inte´ressons, e´tant donne´ une
partie non vide S de I, a` la loi PS de la sous-famille XS = (Xi)i∈S et a` la loi PS¯/S , de
la sous-famille XS¯ = (Xj)j∈S¯ conditionnellement a` XS .
Dans les re´seaux baye´siens posse´dant de nombreaux nœuds et fortement connecte´s,
le calcul de lois ou de lois conditionnelles peut faire intervenir des sommations relatives a`
de tre`s gros sous-ensembles de l’ensemble des indices I. Il y a donc inte´reˆt a` s’efforcer,
au pre´alable, de de´composer, s’il est possible, ces calculs en plusieurs calculs moins
lourds et pouvant eˆtre mene´s en paralle`le. Cette de´composition est lie´e a` des proprie´te´s
du graphe de´finissant le re´seau.
Les formules donnant PS et PS¯/S apparaissent alors comme des produits de facteurs
de´pendant isole´ment des atomes pour des partitions approprie´es.
La construction de ces partitions fait intervenir deux relations d’e´quivalence dans
S¯, toutes deux du type : x et y sont e´quivalents si et seulement s’ils sont relie´s, dans un
graphe non oriente´ (GNO) convenablement de´duit du graphe oriente´ (GO) de´finissant
le re´seau baye´sien, par une chaˆıne ne passant pas par S. Deux tels GNO sont conside´re´s ;
l’un, classique, est le graphe moral, pour lequel les areˆtes relient les nœuds joints par
un arc ou ceux ayant un enfant en commun ; l’autre, a` notre connaissance original, est
le graphe hyper-moral, pour lequel les areˆtes relient les nœuds joints par un arc ou ceux
dont les descendances proches (voir de´finition dans (Smail 2004) et en 2 ci-dessous) ont
une intersection non vide .
La formule de calcul de PS est lie´e a` une structure de re´seau baye´sien dont les nœuds
ne sont pas les e´le´ments de I mais les atomes d’une partition de I (notion introduite
en (Smail 2003) sous le nom de re´seau baye´sien de niveau 2).
- 77 - RNTI-E-5
Re´seaux Baye´siens de Niveau Deux et D-Se´paration.
2 Des partitions remarquables
Etant donne´ S, partie non vide de I, on note S+ la partie commenc¸ante engendre´e
par S, c’est a` dire l’ensemble des e´le´ments de I ayant au moins un descendant dans
S. Nous allons introduire deux partitions de S+ − S ; pour cela nous ferons usage des
notions suivantes
ensemble de descendance proche d’un nœud i : dp(i) est l’ensemble des enfants
de i et de tous les nœuds interme´diaires sur les chemins reliant i a` chacun de ses en-
fants.
ensemble de descendance proche de C : T (C) est l’ensemble des e´le´ments appar-
tenant aux descendances proches des nœuds dans C autre que ceux dans C lui meˆme.
ensemble des racines exte´rieures de C : R(C) est l’ensemble des parents des
e´le´ments de C ∪ T (C) autres que ceux dans C ∪ T (C) lui meˆme,
2.1 Graphes moral et hyper-moral
Etant donne´ un graphe oriente´ sans circuits (I,G), son graphe moral (resp. hyper-
moral) associe´ est le graphe non oriente´ (I,Gm) (resp (I,Ghm) ou` Gm (resp Ghm) est
l’ensemble :
- des paires (i, j) telles que (i, j) ∈ G ou (j, i) ∈ G,
- des paires (i, j) telles que i et j ont un enfant (resp. un descendant proche) en commun.
2.2 Partitions S-morale et S-hyper-morale de S+ − S
On appelle partition S -morale (resp. S-hyper-morale) la partition de S+−S note´e
P
m
S+−S
(resp. Phm
S+−S
), de´finie par la relation d’e´quivalence ∼S+−S (resp. ≈S+−S), pour
laquelle x et y sont e´quivalents si et seulement s’ils sont relie´s par une chaˆıne dans le
graphe moral Gm (resp. hyper-moral Ghm).
2.3 Partition de S
SoitK l’ensemble des e´le´ments de S qui ne sont dans la descendance proche d’aucun
e´le´ment de S+ − S, (dans l’exemple ci dessus, K = {2, 5} ). Alors (voir de´monstration
dans (Smail 2004)), L’ensemble des singletons {k}, ou` k ∈ K (si K 6= ∅) et des parties
T (C) ∩ S+, ou` C ∈ Phm
S+−S
, constitue une partition de S.
3 Factorisation du calcul de PS¯/S et PS
The´ore`me 1 Soit (I,G, (Xi)i∈I) un re´seau baye´sien et soit S une partie non vide de
I. Soit Pm
S+−S
la partition S-morale de S+ − S. Alors
PS¯/S =
∏
i6∈S+
Pi/p(i)
∏
C∈Pm
S+−S
PC/F (C)∩S+ (1)
- 78 -RNTI-E-5
Smail et Raoult
2
7
9
3
1 2
7
9
3
1
8
  
 5
10
4
6
10
 5
8
4
(a)                                                                          (b)
6
  
S = {2, 3, 5, 8, 9, 10}
Fig. 1 – (a) : Phm
S¯
la partition S-hyper-morale. (b) : Pm
S¯
la partition S-morale.
ou`
PC/F (C)∩S+ =
∏
i∈C∪(e(C)∩S+) Pi/p(i)
∑
C
∏
i∈C∪(e(C)∩S+) Pi/p(i)
. (2)
The´ore`me 2 Soit (I,G, PI) un re´seau baye´sien et soit S une partie de I. Soit P
hm
S+−S
la partition S-hyper-morale de S+ − S et soit K l’ensemble des e´le´ments de S qui ne
sont dans la descendance proche d’aucun e´le´ment de S+ − S. Alors
PS =
∏
k∈K
Pk/p(k)
∏
C∈Phm
S+−S
PT (C)/R(C)
ou`
PT (C)/R(C) =
∑
C
∏
i∈C∪T (C)
Pi/p(i)(xi/xp(i))
Ce the´ore`me (dont on trouve la de´monstration dans (Smail 2004)) s’interpre`te natu-
rellement dans le cadre des RB2 :
Corollaire 1 Sous les hypothe`ses du the´ore`me 2, la partition Qs (= {{k}; k ∈ K} ∪
{T (C);C ∈ Phm
S¯
}) munit S de la structure de re´seau baye´sien de niveau deux, ou` la
structure de graphe ordonne´, G′, est de´finie par :
si k ∈ K et k′ ∈ K, (k, k′) ∈ G′ si (k, k′) ∈ G
si k ∈ K et C ∈ Phm
S¯
, (k, T (C)) ∈ G′ si k ∈ R(C)
si C ∈ Phm
S¯
et C′ ∈ Phm
S¯
, (T (C), T (C′)) ∈ G′ si T (C) ∩R(C′) 6= ∅
(mais il n’existe pas de couple (T (C), k) appartenant a` G′).
- 79 - RNTI-E-5
Re´seaux Baye´siens de Niveau Deux et D-Se´paration.
On remarque que le the´ore`me 2 fournit en fait une structure de RB2 renseigne´
puisqu’il pre´cise, pour tout atome A de Qs, quels sont exactement les e´le´ments de I,
appartenant aux parents de A (pour G′), qui interviennent comme conditionnement de
cet atome. Dans l’exemple de la figure 1, voici la repre´sentation du RB2 sur S
23 5
8 109
Fig. 2 – Re´seau baye´sien de niveau deux repre´sentant PS.
Re´fe´rences
Finn, V. Jensen (1996), An Introduction to Bayesian Networks, Springer Verlag, New
York.
Judea, Pearl (1986), Fusion propagation and structuring in belief networks, Artificial
Intelligence 29 (3) 241–288
Judea, Pearl (1988), Probabilistic Reasoning in Intelligent Systems. Morgan-Kaufmann,
San Mateo.
Petr Ha´jek, Toma´s Havra´nek and Radim Jirous´ek (1992), Information Processing in
Expert Systems, CRC Press.
Smail Linda (2003), Calcul des lois conditionnelles dans les re´seaux baye´siens, 35e`mes
Journe´es de Statistique, Lyon.
Smail Linda (2004), Algorithmique pour les re´seaux baye´siens et leurs extensions,
The`se en Mathe´matiques Applique´es soutenue en 2004, Universite´ de Marne-la-
Valle´e.
Summary
Given a family of random variables, say (Xi)i∈I , endowed with the structure of
bayesian network, and a subset S of I, we consider the problem of computing the
distribution of the subfamily (Xa)a∈S (resp. the distribution of (Xb)b∈S¯ , where S¯ =
I−S, conditionnally to (Xa)a∈S). We present how it is possible to decompose this task
into several parallel computations, each of them related to a subset of S (resp. of S¯) ;
these partial results are then put together as a product. Concerning the computation
of (Xa)a∈S , this amounts to the exhibition of a structure of bayesian network of level
2 on S.
- 80 -RNTI-E-5
