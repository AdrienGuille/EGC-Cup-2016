Me´langes gaussiens bidimensionnels pour la
comparaison de deux e´chantillons de
chromatine immunopre´cipite´e
Caroline Be´rard1, Marie-Laure Martin-Magniette1,2, Alexandra To3, Franc¸ois Roudier3,
Vincent Colot3 et Ste´phane Robin1.
1 UMR AgroParisTech/INRA MIA 518, 16 rue Claude Bernard, PARIS Cedex 05.
2 UMR INRA 1165 - CNRS 8114 - UEVE URGV, 2 rue Gaston Cre´mieux, EVRY.
3 UMR CNRS 8186, De´partement de Biologie, 46 rue d’Ulm, PARIS Cedex 05.
caroline.berard@agroparistech.fr , marie laure.martin@agroparistech.fr
to@biologie.ens.fr , roudier@biologie.ens.fr
colot@biologie.ens.fr , stephane.robin@agroparistech.fr
Re´sume´ L’immunopre´cipitation de la chromatine (ChIP) permet d’e´tudier les in-
teractions entre les prote´ines et l’ADN ainsi que diffe´rents e´tats chromatiniens. Le
ChIP-chip est une technique combinant l’immunopre´cipitation de la chromatine avec
le principe des puces a` ADN, ce qui permet une e´tude a` l’e´chelle du ge´nome. Nous
nous inte´ressons ici a` l’analyse des diffe´rences entre deux e´chantillons d’ADN im-
munopre´cipite´. Biologiquement, on s’attend a` distinguer quatre groupes diffe´rents :
un groupe d’ADN non-immunopre´cipite´, un groupe d’ADN immunopre´cipite´ identi-
quement dans les deux e´chantillons et deux groupes dans lesquels l’ADN est immu-
nopre´cipite´ en quantite´s diffe´rentes. Nous mode´lisons ces donne´es par un me´lange de
gaussiennes bidimensionnelles a` quatre composants. Les matrices de variance sont
contraintes afin d’inte´grer des connaissances biologiques. Les parame`tres sont estime´s
par l’algorithme EM. Nous appliquons cette me´thode pour e´tudier la diffe´rence de
me´thylation d’une histone entre l’e´cotype sauvage de la plante mode`le Arabidopsis
thaliana et un mutant.
Mots-cle´s : Me´lange gaussien, de´composition spectrale, algorithme EM,
ChIP-chip.
Re´sume´ Chromatin immunoprecipitation (ChIP) enables to investigate interac-
tions between proteins and DNA and also various chromatin states. ChIP-chip is
a well-established procedure combining chromatin immunoprecipitation with DNA
microarrays, which allows a study of the whole genome. We are interested in the
analyze of the differences between two immunoprecipitated DNA samples. From a
biological point of view, we expect to distinguish four different groups : a group of
non-immunoprecipited DNA, a group of immunoprecipited DNA in both samples,
and then two groups in which DNA is differently immunoprecipited. We propose to
model these data with a mixture of two-dimensional Gaussians with four compo-
nents. Biological knowledges are included as constraints on the variance matrices.
The parameters are estimated by the EM algorithm. This method is applied to Nim-
bleGen data in order to study the histone methylation difference between the wild
ecotype of the model plant Arabidopsis thaliana and a mutant.
Keywords : Gaussian mixture, eigenvalue decomposition, EM algorithm,
ChIP-chip.
c© Revue MODULAD, 2009 -53- Nume´ro 40
1 Introduction
La connaissance des me´canismes de re´gulation des ge`nes est essentielle pour com-
prendre certains concepts biologiques importants. On sait par exemple que le de´veloppement
d’un organisme de´pend grandement de l’harmonisation de l’expression de ses ge`nes. Apre`s
le se´quenc¸age entier des ge´nomes a` grande e´chelle, le de´fi consiste donc aujourd’hui a` com-
prendre le fonctionnement des ge`nes, c’est-a`-dire a` de´terminer leur fonction et leur patron
d’expression.
Dans le noyau des cellules eucaryotes, l’ADN est fractionne´ en chromosomes et il est
condense´ sous forme de chromatine. La chromatine est un complexe ADN-prote´ines qui
joue un roˆle essentiel dans le controˆle de l’activite´ des ge`nes. Les prote´ines pre´sentes
sont principalement des histones. La condensation de l’ADN en chromatine s’organise
de manie`re se´quentielle et ordonne´e. En premier lieu, 147 paires de bases d’ADN s’en-
roulent autour d’un octame`re d’histones pour former un nucle´osome. Dans un second
niveau d’organisation, les nucle´osomes se compactent et forment une he´lice. Cette he´lice
est finalement condense´e en euchromatine (condensation le´ge`re) ou en he´te´rochromatine
(condensation plus prononce´e) constituant un troisie`me niveau d’organisation. Les ge`nes
localise´s dans l’euchromatine peuvent eˆtre plus facilement transcrits car la condensation
est le´ge`re. Cette structure d’organisation du ge´nome dans le noyau constitue en elle-meˆme
un me´canisme de re´pression ou d’activation de la transcription des ge`nes. En effet, pour
activer la transcription d’un ge`ne donne´ dans une cellule, la chromatine comprise dans la
re´gion de controˆle du ge`ne doit eˆtre modifie´e ou alte´re´e de fac¸on a` eˆtre permissive a` la
transcription. Les modifications post-traductionnelles d’histone (comme la me´thylation,
l’ace´tylation, l’ubiquitination ou la phosphorilation) sont des me´canismes implique´s dans
la re´gulation de l’expression des ge`nes (Turck et al. [18]).
L’immunopre´cipitation de la chromatine (ChIP) permet d’e´tudier les interactions entre
les prote´ines et l’ADN ainsi que diffe´rents e´tats chromatiniens associe´s a` des e´tats d’acti-
vite´ distincts du ge´nome. Le ChIP-chip est une technique combinant l’immunopre´cipitation
de la chromatine avec le principe des puces a` ADN (Amaratunga et Cabrera [1]), ce qui
permet une e´tude a` l’e´chelle du ge´nome. Habituellement dans une expe´rience de ChIP-
chip, les deux e´chantillons co-hybride´s sont les fragments d’ADN associe´s a` la prote´ine
d’inte´reˆt ou a` une marque chromatinienne (IP) et l’ADN ge´nomique total (INPUT). Le
but est ensuite de de´tecter les sondes de la puce pour lesquelles il y a un signal IP afin
d’identifier les re´gions ge´nomiques ou` la prote´ine d’inte´reˆt se fixe.
Buck et Lieb [7] ont montre´ la ne´cessite´ de de´velopper de nouvelles me´thodes statis-
tiques pour de´tecter les sondes enrichies dans les expe´riences de ChIP-chip. Re´cemment,
deux strate´gies ont e´te´ largement applique´es : la premie`re tient compte de la structure
spatiale des donne´es (Cawley et al. [9], Keles [14]) et la seconde conside`re que la totalite´
des sondes peut eˆtre divise´e en deux populations : les sondes enrichies et les non-enrichies
(Buck et Lieb [7], Turck et al. [18], Martin-Magniette et al. [15]). Diffe´rentes me´thodes
statistiques ont e´te´ propose´es pour distinguer ces deux populations : toutes sont fonde´es
sur la distribution du log-ratio log(IP/INPUT ) (Buck et Lieb [7], Turck et al. [18]),
excepte´e la me´thode propose´e par Martin-Magniette et al. [15] qui utilise un me´lange de
re´gressions pour mode´liser la loi de l’IP conditionnellement a` l’INPUT.
c© Revue MODULAD, 2009 -54- Nume´ro 40
La technique du ChIP-chip permet e´galement d’e´tudier directement la diffe´rence entre
deux e´chantillons d’ADN immunopre´cipite´s, sans hybrider sur la puce l’ADN ge´nomique
total (INPUT). A` notre connaissance il n’existe pas de me´thode pour analyser ce type de
donne´es (IP/IP) dans la litte´rature. Les me´thodes de segmentation initialement de´veloppe´es
pour l’analyse des donne´es CGH (Hupe´ et al. [13], Olshen et al. [16], Picard et al. [17])
pourraient eˆtre utilise´es, mais les re´gions ge´nomiques non immunopre´cipite´es et les re´gions
immunopre´cipite´es identiquement dans les deux e´chantillons seraient indistinguables. De
plus ces me´thodes sont assez couˆteuses en temps de calcul pour des puces tiling-array qui
ont un grand nombre de sondes.
L’objectif de notre travail est de proposer une mode´lisation conjointe des signaux IP
obtenus par un mode`le de me´lange de gaussiennes bi-dimensionnelles. La description des
donne´es est de´taille´e section 2. Les me´langes gaussiens bidimensionnels mode´lise´s a` l’aide
d’une de´composition de la matrice de variance sont e´tudie´s section 3. Les connaissances
biologiques sont prises en compte sous forme de contraintes sur les parame`tres du mode`le
et sur le nombre de composants. Cette mode´lisation est de´taille´e dans la section 4. Une ap-
plication de la me´thode sur des donne´es issues de la technologie NimbleGen est pre´sente´e
dans la section 5.
2 Description des donne´es
Les donne´es analyse´es concernent la plante mode`le Arabidopsis thaliana. Les deux
e´chantillons co-hybride´s sur la puce visent a` e´tudier le comportement de l’histone H3
dime´thyle´e au niveau de la lysine 9 (H3K9me2). On compare un e´chantillon sauvage et
un e´chantillon mutant (mutant nrpdlalb).
L’expe´rience est faite en dye-swap (Boulicaut et Gandrillon [6]) : le principe est de faire
une re´pe´tition technique en inversant les marquages. Chaque traitement est ainsi marque´
par les deux fluorochromes, ce qui permet de controˆler le biais duˆ au marquage (biais
technique). Les intensite´s des signaux sont ensuite moyenne´es sur le dye-swap.
La puce a` ADN utilise´e est une puce tiling-array a` oligos courts issue de la technolo-
gie NimbleGen. Cette puce permet d’e´tudier le ge´nome nucle´aire d’Arabidopsis thaliana,
compose´ de cinq chromosomes et des ge´nomes mitochondrial et chloroplastique. La puce
est constitue´e d’environ 700 000 sondes.
Lorsque l’on e´tudie des donne´es de ChIP-chip IP/IP, on s’attend a` distinguer quatre
groupes (cf Figure 1) :
– Un groupe d’intensite´ faible qui correspond aux se´quences d’ADN qui ne sont pas
immunopre´cipite´es (bruit).
– Un groupe ou` les se´quences d’ADN sont immunopre´cipite´es en meˆme quantite´ chez
le sauvage et chez le mutant. Cela correspond aux endroits sur le ge´nome ou` l’histone
est me´thyle´e identiquement dans les deux e´chantillons. Ce groupe sera de´fini dans
la suite comme groupe normal.
– Deux groupes ou` les se´quences d’ADN sont immunopre´cipite´es en quantite´s diffe´rentes
c© Revue MODULAD, 2009 -55- Nume´ro 40
chez le sauvage et chez le mutant. Le taux de me´thylation de l’histone H3K9me2
peut eˆtre plus faible chez le mutant (groupe appauvri), ou bien au contraire, plus
e´leve´ (groupe enrichi).
Fig. 1 – Comparaison de deux e´chantillons de chromatine immunopre´cipite´e (sauvage vs
mutant) : Identification sche´matique des diffe´rents groupes.
3 Mode`le de me´langes gaussiens bidimensionnels
Dans cette section, nous rappelons brie`vement l’approche de classification par les
me´langes gaussiens et reprenons la mode´lisation des mode`les de me´langes gaussiens a`
l’aide d’une de´composition des matrices de variance, puis nous appliquons certains mode`les
de´finis dans Biernacki et al. [4] a` nos donne´es.
3.1 Approche par classification
Si le but de l’analyse est la classification, le label de chaque donne´e est manquant
au regard de l’e´chantillon observe´. Notons Zik, ce label pour l’individu i, qui est une
variable ale´atoire e´gale a` 1 si le point xi appartient a` la population k et 0 sinon. Les va-
riables {Z1, ...Zn} (avec Zi = {Zi1, ..., ZiK}) sont suppose´es inde´pendantes et suivent une
loi multinomiale de probabilite´s pi1, ..., piK , qui sont les proportions des K classes dans le
me´lange. Si nous notons Y le vecteur des donne´es comple`tes (X,Z) ou` seul X est observe´,
alors cette reformulation montre clairement que les mode`les de me´lange peuvent eˆtre vus
comme un cas particulier des mode`les a` structure cache´e comme par exemple les mode`les
de Markov cache´s (Cappe´ et al. [8], Ephraim et Merhav [12]), la diffe´rence e´tant que les
variables {Z1, ...Zn} sont suppose´es ici inde´pendantes.
c© Revue MODULAD, 2009 -56- Nume´ro 40
Dans notre travail, la variable observe´e Xi = (X1i, X2i) est le signal log-IP de chaque
e´chantillon pour la sonde i et nous supposons que les observations proviennent d’un
me´lange de densite´s gaussiennes. La densite´ du couple s’e´crit :
f(Xi, ψ) =
K∑
k=1
pikφ(Xi|µk,Σk),
ou` pik est la proportion du k -ie`me composant du me´lange (0 < pik < 1 ∀k = 1, ..., K et∑K
k=1 pik = 1), ψ = (pi1, ..., piK−1, µ1, ..., µK ,Σ1, ...,ΣK) est le vecteur des parame`tres du
me´lange et φ(.|µk,Σk) est la densite´ d’une distribution gaussienne bidimensionnelle de
moyenne µk et de variance Σk de´finis au point xi par :
φ(xi|µk,Σk) = 1
2pi
[det(Σk)]
−1/2 exp
{
−1
2
(xi − µk)′Σ−1k (xi − µk)
}
,
ou` M’ repre´sente la transpose´e de M.
Nous calculons les probabilite´s conditionnelles que la sonde i appartienne a` chacun
des groupes sachant l’ensemble des observations. Nous rappelons que par de´finition, la
probabilite´ conditionnelle que la sonde i appartienne au groupe k sachant l’ensemble des
observations est de´finie par :
τik =
pˆikφ(Xi|µˆk, Σˆk)∑K
l=1 pˆilφ(Xi|µˆl, Σˆl)
.
Nous pouvons ensuite classer la sonde i en l’attribuant au groupe pour lequel la probabilite´
conditionnelle est la plus grande (re`gle du Maximum A Posteriori).
3.2 Parame´trisation spectrale des matrices de variance
La densite´ gaussienne mode´lise une distribution ellipso¨ıdale de centre µk dont les ca-
racte´ristiques ge´ome´triques (volume, forme, orientation) sont de´finies a` l’aide d’une de´composition
spectrale de la matrice de variance Σk. Pour cela, nous reprenons une parame´trisation
propose´e par Banfield et Raftery [2] qui permet de proposer de nombreux mode`les de
classification. Cette parame´trisation conside`re la de´composition spectrale des matrices de
variance :
Σk = λkDkAkD
′
k , (1)
ou` λk repre´sente le volume (λk = det(Σk)
1/2), Dk repre´sente l’orientation et Ak repre´sente
la forme de l’ellipse. La matrice Dk est la matrice des vecteurs propres de Σk et Ak
est une matrice diagonale telle que det(Ak) = 1 avec les valeurs propres normalise´es de
Σk sur la diagonale dans l’ordre de´croissant. En permettant aux parame`tres volumes,
formes et orientations de varier ou d’eˆtre e´gaux entre les classes, on obtient 14 mode`les de
me´langes gaussiens diffe´rents et facilement interpre´tables. Les 14 mode`les sont de´taille´s
dans Celeux et Govaert [10] : il y a 8 mode`les ge´ne´raux, 4 mode`les avec des matrices de
variance diagonales et 2 mode`les avec des formes sphe´riques (Ak = I).
c© Revue MODULAD, 2009 -57- Nume´ro 40
3.3 Application de 4 mode`les de classification aux donne´es
Les 14 mode`les de classification (Celeux et Govaert [10]) sont imple´mente´s dans le
logiciel MIXMOD [4]. A` la vue des donne´es IP/IP (cf Figure 1), nous conside´rons unique-
ment les mode`les a` quatre composants d’orientations diffe´rentes, c’est-a`-dire les mode`les
λDkAD
′
k, λkDkAD
′
k, λDkAkD
′
k et λkDkAkD
′
k. En reprenant les conventions de Celeux
et Govaert [10], nous notons λ (respectivement D, A) lorsque le volume (respectivement
l’orientation, la forme) est e´gal pour tous les composants, et λk (respectivement Dk, Ak)
lorsque le volume (respectivement l’orientation, la forme) est diffe´rent pour tous les com-
posants.
On peut choisir le meilleur mode`le a` l’aide du crite`re BIC ou du crite`re ICL. Le crite`re BIC
(Bayesian Information Criterion, Schwarz (1978)) est tre`s utilise´ pour les mode`les a` struc-
ture cache´e, en particulier les mode`les de me´lange. Soit x = (x1, ..., xn) un n-e´chantillon
ou` xi = (xi1, xi2) est le signal log-IP observe´ pour un individu i, le crite`re BIC du mode`le
m vaut :
BICm = −2 log
{
f(x|ψˆm)
}
+ νm log(n),
ou` ψˆm est l’estimateur des parame`tres pour le mode`le m et νm est le nombre de parame`tres
du mode`le m. Le crite`re ICL (Integrated Complete-data Likelihood, Biernacki et al. [5])
prend en compte la capacite´ d’un mode`le de me´lange a` re´ve´ler une structure en classes
dans les donne´es. Il correspond au crite`re BIC pe´nalise´ par un terme d’entropie qui mesure
le degre´ d’imbrication des composants :
ICLm = BICm +Hm,
ou` Hm correpond a` l’entropie du mode`le m, avec :
Hm = −2
n∑
i=1
K∑
k=1
zik log(τik).
Les deux crite`res se´lectionnent le mode`le λkDkAkD
′
k. Ce mode`le est celui qui a le plus
de parame`tres a` estimer (23 parame`tres pour un me´lange de 4 gaussiennes bidimension-
nelles), ce qui n’est pas un proble`me e´tant donne´ le tre`s grand nombre de donne´es (environ
150 000 observations par jeu de donne´es).
Les re´sultats obtenus avec le mode`le λkDkAkD
′
k ne nous satisfont pas (cf Figure 2). En
effet, un seul composant couvre les groupes enrichi et appauvri et trois composants sont
presque concentriques autour du groupe d’ADN non immunopre´cipite´ (bruit). Ceci est duˆ
au fait que la densite´ de points est beaucoup plus importante au niveau du groupe d’ADN
non immunopre´cipite´ qui regroupe environ 50% des donne´es.
Les mode`les non choisis par les crite`res BIC et ICL et qui conside`rent un volume,
λ, constant pour les quatres composants sont un peu meilleurs du point de vue de l’in-
terpre´tation, mais deux composants sont tre`s chevauchants et on ne retrouve pas le groupe
d’ADN non immunopre´cipite´. Beaucoup de sondes sont alors classe´es dans le groupe ap-
pauvri a` tort (cf Figure 3).
c© Revue MODULAD, 2009 -58- Nume´ro 40
Fig. 2 – Droite : Isodensite´ des 4 gaussiennes pour le mode`le λkDkAkD
′
k, Gauche : Clas-
sement des sondes en 4 groupes avec la re`gle du MAP
Fig. 3 – Droite : Isodensite´ des 4 gaussiennes pour le mode`le λDkAkD
′
k, Gauche : Clas-
sement des sondes en 4 groupes avec la re`gle du MAP
4 Mode´lisation des donne´es avec prise en compte des
connaissances biologiques
4.1 Mode´lisation
Afin de mode´liser au mieux les donne´es, nous ajoutons des contraintes aux mode`les
de´taille´s section 3.3. Les contraintes supple´mentaires sont de´duites de connaissances bio-
logiques que nous avons sur les donne´es. En effet, nous avons vu dans la section 2 que
l’on s’attend a` identifier 4 groupes diffe´rents lorsqu’on analyse des donne´es de ChIP-chip
IP/IP. Le nombre de composants du mode`le de me´lange est donc fixe´ a` K=4. De plus,
nous avons certaines connaissances sur les 4 groupes que l’on souhaite identifier : le groupe
d’ADN non immunopre´cipite´ et le groupe normal ont la meˆme orientation proche de la
premie`re bissectrice. D’autre part, on suppose que le bruit est e´gal dans chaque groupe,
ce qui revient a` fixer la deuxie`me valeur propre de Σk. En effet, la premie`re valeur propre
est associe´e au grand axe de l’ellipse et la deuxie`me est associe´e au petit axe de l’ellipse.
c© Revue MODULAD, 2009 -59- Nume´ro 40
Cette dernie`re hypothe`se est utile pour contraindre la mode´lisation car des variances
he´te´rosce´dastiques donnent souvent des re´sultats tre`s instables et ne permettent pas de
retrouver les 4 groupes de la Figure 1.
Nous reprenons la parame´trisation de´finie section 3.2 :
Σk = λkDkAkD
′
k.
Afin d’avoir le meˆme bruit dans chaque groupe, on contraint la seconde valeur propre de
Σk a` eˆtre constante dans les 4 groupes. Les deux groupes qui ont la meˆme orientation
auront la meˆme matrice D. En utilisant la de´composition des matrices de variance et sous
nos contraintes, on obtient donc :
Σk = λkDkAkD
′
k = DkΛkD
′
k, pour k = 1, .., 4, avec Λk = λkAk
D1 = D2 = D
Λk =
(
u1k 0
0 u2
)
, avec u1k > u2, pour k = 1, .., 4.
De manie`re plus ge´ne´rale, on peut e´crire :{
Σk = D
′
kΛkDk si k ≥ 2
Σk = D
′ΛkD si k < 2,
ou` les groupes 1 et 2 correspondent aux groupes de meˆme orientation (groupe normal
et groupe d’ADN non immunopre´cipite´) et la matrice Λk est une matrice diagonale qui
contient les valeurs propres de Σk.
L’originalite´ de ce mode`le est de proposer la possibilite´ d’avoir certains composants
avec une orientation fixe et d’autres composants avec une orientation libre. De plus il est
possible de fixer seulement l’une des deux valeurs propres dans le choix du volume et de
la forme pour un meˆme composant du mode`le. Dans le logiciel MIXMOD [4], le choix de
fixer ou pas le volume, l’orientation ou la forme est obligatoirement le meˆme pour tous
les composants du mode`le.
4.2 Estimation des parame`tres par l’algorithme EM
Si le label de chaque donne´e e´tait observe´, l’estimation des parame`tres du me´lange
serait e´vidente puisque les parame`tres de chaque composant φ(xi;µk,Σk) seraient estime´s
avec les individus de la population k. Mais les labels sont inconnus et l’estimation ne peut
eˆtre fonde´e que sur les donne´es observe´es x1, ..., xn. Il n’existe pas de formules explicites
pour les estimateurs des parame`tres d’un me´lange, on a besoin de proce´dures d’estimation
ite´ratives. Le vecteur de parame`tres Ψ = (pi1, ..., pi3, µ1, ..., µ4,Σ1, ...,Σ4) est estime´ a` l’aide
de l’algorithme EM.
Pour trouver l’estimateur des matrices de variance Σk, il faut maximiser l’espe´rance de la
log-vraisemblance des donne´es comple´te´es en Σk, ce qui revient a` minimiser F en D, Dk
et Λk, ou` F est de´finie par :
F =
2∑
k=1
tr(D′WkDΛ−1k ) +
4∑
k=3
tr(D′kWkDkΛ
−1
k ) +
4∑
k=1
nk log {det(Λk)} ,
c© Revue MODULAD, 2009 -60- Nume´ro 40
ou` Wk =
∑n
i=1 τik(xi − x¯k)(xi − x¯k)′.
On remarque que seul Λk est pre´sent dans les 3 termes de F. Pour D et Dk, minimiser
F revient simplement a` minimiser le terme ou` ils apparaissent. L’estimateur de Dk pour
k = 3, 4 est le meˆme que celui propose´ par Celeux et Govaert [10] pour des composants
d’orientations diffe´rentes, c’est-a`-dire Dˆk est la matrice des vecteurs propres de Wk.
Proposition 1 SoitWk =
∑n
i=1 τik(xi−x¯k)(xi−x¯k)′ est une matrice de la forme
(
w1k w2k
w2k w4k
)
.
L’estimateur du maximum de vraisemblance de la matrice d’orientation D identique pour
les deux premiers composants est de la forme
( √
dˆ −
√
1− dˆ√
1− dˆ
√
dˆ
)
, ou` dˆ est un re´el
positif de´fini par :
dˆ =

1
2
+
P2
k=1(w1k−w4k)
2
n√
(
P2
k=1(w1k−w4k))2+4(
P2
k=1(w2k))
2
o si
∑2
k=1(w1k − w4k) > 0
1
2
−
P2
k=1(w1k−w4k)
2
n√
(
P2
k=1(w1k−w4k))2+4(
P2
k=1(w2k))
2
o sinon.
(2)
Ide´e de la preuve 1 Minimiser F en D revient a` minimiser f(D) =
∑2
k=1 tr(DΛ
−1
k D
′Wk).
On peut re´e´crire f(D) sous la forme suivante :
f(D) =
2∑
k=1
(
d′1Wkd1
u1k
+
d′2Wkd2
u2
)
,
ou` d′1 est le premier vecteur de la matrice D et d
′
2 le second.
Puisque D est une matrice orthogonale et norme´e, elle est de la forme
( √
d −√1− d√
1− d √d
)
.
En de´veloppant f(D) et en de´rivant par rapport a` d, on obtient un poˆlynome de degre´ 4
en d qui se re´sout facilement. On remarque alors que D ne de´pend plus de Λ. Ce re´sultat
analytique n’est valable qu’en dimension 2. 
Proposition 2 Soit Bk la matrice de´finie par Bk = D
′
kWkDk de la forme
(
b1k b3k
b4k b2k
)
.
L’estimateur du maximum de vraisemblance de Λk est de la forme
(
uˆ1k 0
0 uˆ2
)
, ou`
{
uˆ1k = b1k/nk
uˆ2 =
∑4
k=1 b2k/n
(3)
Ide´e de la preuve 2 En de´veloppant la trace et le de´terminant, on peut re´e´crire F sous
la forme :
F =
4∑
k=1
(b1ku
−1
1k + b2ku
−1
2 ) +
4∑
k=1
nk {log(u1k) + log(u2)} ,
et minimiser F en Λk revient a` minimiser F en u1k et u2. 
c© Revue MODULAD, 2009 -61- Nume´ro 40
L’estimateur de Σk est donc :
Σˆk =
{
Dˆ′kΛˆkDˆk si k ≥ 2
Dˆ′ΛˆkDˆ si k < 2,
avec Dˆ de´fini par (2), Dˆk est la matrice des vecteurs propres de Wk et Λˆk de´fini par (3).
5 Application sur un jeu de donne´es re´el
Nous appliquons cette me´thode sur les donne´es de me´thylation d’histone pre´sente´es
section 2. Les donne´es analyse´es concernent le chromosome 4 d’Arabidopsis thaliana qui
est couvert par 111 699 sondes.
5.1 Initialisation de l’algorithme EM
Les re´sultats fournis par l’algorithme EM sont de´pendants de l’initialisation. Il est im-
portant de choisir une bonne initialisation afin de ne pas tomber sur un maximum local.
En pratique, on peut initialiser l’algorithme avec les re´sultats fournis par les diffe´rents
mode`les de MIXMOD [4] ou bien de´finir une classification initiale bien choisie. Il est sou-
vent plus facile de de´finir des probabilite´s conditionnelles pour chaque sonde (on peut par
exemple s’appuyer sur la Figure 1) que de proposer une matrice initiale Σk pertinente.
Le crite`re d’arreˆt choisi pour l’algorithme EM est un crite`re de convergence sur les pa-
rame`tres avec ε = 10−6.
Nous avons teste´ 11 initialisations diffe´rentes et les re´sultats obtenus diffe`rent selon l’ini-
tialisation. Huit des 11 initialisations nous donnent le mode`le auquel on s’attend biologi-
quement repre´sente´ sche´matiquement Figure 1. Mais il reste des diffe´rences : les sondes
difficiles a` classer qui sont au centre des 4 composants sont, selon les mode`les, classe´es soit
normales, soit appauvries, soit la moitie´ est classe´e appauvrie et l’autre moitie´ enrichie.
Les parame`tres estime´s des composants ne sont alors pas les meˆmes.
5.2 Crite`res BIC et ICL
La se´lection de mode`les permet de choisir le mode`le minimisant le crite`re BIC ou le
crite`re ICL donne´s section 3.3. Le mode`le minimisant a` la fois le crite`re BIC et le crite`re
ICL est le mode`le λkDkAkD
′
k pre´sente´ Figure 2 (cf Table 1). Ce n’est pas le mode`le que
l’on voudrait se´lectionner biologiquement. Ceci est surement duˆ au fait que les classes ne
sont pas des gaussiennes en re´alite´.
5.3 Estimation des parame`tres
Nous pre´sentons les re´sultats du mode`le initialise´ avec des probabilite´s conditionnelles.
Les parame`tres du me´lange estime´s par l’algorithme EM sont donne´s dans la Table 2. Les
proportions de chacun des groupes correspondent a` celles attendues par les biologistes. En
effet, on sait que la me´thylation de cette histone n’est pre´sente qu’en faible proportion dans
le ge´nome. Or nous trouvons environ 39% des sondes dans le groupe non immunopre´cipite´.
Nous savons aussi que la diffe´rence de me´thylation est majoritairement appauvrie chez
c© Revue MODULAD, 2009 -62- Nume´ro 40
Mode`le λkDkAkD
′
k Mode`le λDkAkD
′
k Mode`le 1 Mode`le 2
nb de parame`tres 23 20 18 18
BIC 578 171 637 770 606 643 613 470
ICL 607 488 690 126 639 101 640 582
Tab. 1 – Crite`res BIC et ICL selon les mode`les. Mode`le 1 correspond a` notre mode`le ini-
tialise´ avec des probabilite´s conditionnelles, Mode`le 2 correspond a` notre mode`le initialise´
avec des parame`tres bien choisis
le mutant et tre`s rarement enrichie. Le groupe appauvri regroupe 22% des sondes et le
groupe enrichi en regroupe seulement 13%.
D’autre part, la matrice d’orientation D estime´e pour les groupes 1 et 2 est tre`s proche
de la matrice d’orientation attendue pour une direction sur la premie`re bissectrice.
Groupe 1 Groupe 2 Groupe 3 Groupe 4
pˆi 0.39 0.26 0.13 0.22
µˆ [7.56 ;7.54] [12.19 ;12.04] [8.07 ;9.17] [9.10 ;7.95]
Dˆ
(
0.71 −0.70
0.70 0.71
) (
0.71 −0.70
0.70 0.71
) (
0.32 −0.94
0.94 0.32
) (−0.96 0.26
−0.26 −0.96
)
Λˆ
(
0.11 0
0 0.14
) (
9.42 0
0 0.14
) (
1.41 0
0 0.14
) (
1.29 0
0 0.14
)
Σˆ
(
0.12 −0.01
−0.01 0.12
) (
4.8 4.64
4.64 4.75
) (
0.27 0.39
0.39 1.28
) (
1.21 0.29
0.29 0.22
)
Tab. 2 – Estimation des parame`tres. Les groupes 1 et 2 correspondent aux groupes
normaux (le groupe 1 est le groupe non-immunopre´cipite´), le groupe 3 correspond au
groupe enrichi et le groupe 4 correspond au groupe appauvri.
On obtient quatre groupes en classant chaque sonde dans le groupe pour laquelle la
probabilite´ conditionnelle est la plus grande (cf Figure 4).
D’un point de vue biologique, le plus important est dans un premier temps de distinguer
les sondes enrichies ou appauvries (c’est-a`-dire la` ou` le taux de me´thylation est diffe´rent
entre le sauvage et le mutant). On peut donc conside´rer les groupes de meˆme orientation
(groupes 1 et 2) comme un seul groupe qui correspond a` un taux de me´thylation iden-
tique dans les deux e´chantillons (groupe normal). On veut donc classer les sondes en trois
groupes : normal, appauvri ou enrichi. Pour cela, on somme les probabilite´s conditionnelles
des groupes 1 et 2. Une autre possibilite´ est de classer en deux groupes seulement, un
groupe qui correspond a` une me´thylation identique dans les deux e´chantillons, et l’autre
qui correspond a` un taux de me´thylation diffe´rent entre les deux e´chantillons. Pour cela,
c© Revue MODULAD, 2009 -63- Nume´ro 40
on somme les probabilite´s conditionnelles des groupes 1 et 2 et celles des groupes 3 et 4.
Lorsque l’on classe en 4 groupes, on trouve bien les 4 groupes comme attendus sur la figure
1, mais il est probable que les sondes aux frontie`res de deux classes aient des probabilite´s
conditionnelles tre`s proches pour les deux classes et soient donc mal classe´es. Comme
nous pre´fe´rons ne pas avoir d’information sur une sonde plutoˆt que d’avoir une informa-
tion fausse, nous fixons un seuil de classification a` 0.7, ce qui de´limite une marge de non
classement autour de chacun des groupes (cf Figure 5). Avec un seuil a` 0.7, seulement
12.5% des sondes ne sont pas classe´es. On peut bien suˆr faire de meˆme avec les classements
en 2 ou 3 groupes, le nombre de sondes non classe´es est alors plus faible (11.9% pour un
classement en 3 groupes et 9.3% pour un classement en 2 groupes).
Fig. 4 – Classement des sondes en 4 groupes (gauche), 3 groupes (centre), 2 groupes
(droite).
Fig. 5 – Classement des sondes en 4 groupes (gauche) avec un seuil de classification a` 0.7
(zone en gris), 3 groupes (centre), 2 groupes (droite).
c© Revue MODULAD, 2009 -64- Nume´ro 40
5.4 Interpre´tations biologiques
Nous avons ensuite compare´ les re´sultats a` l’annotation connue d’Arabidopsis tha-
liana a` l’aide du logiciel SignalMapTM fourni par NimbleGen (cf Figure 6). Bien que
notre mode`le ne prenne pas en compte la structure spatiale des sondes le long du chro-
mosome, les sondes de´clare´es normales, enrichies ou appauvries chez le mutant sont re-
groupe´es sous forme de plage. On s’attend e´videmment a` ce que des sondes contigu¨es
aient le meˆme comportement. D’autre part, la marque H3K9me2 e´tudie´e est une marque
he´te´rochromatinienne pre´sente sur environ 15% du ge´nome. La plupart des re´gions cou-
vertes par H3K9me2 sont contigu¨es et couvrent plusieurs me´gabases dans les re´gions
pe´ricentrome´riques ou dans l’he´te´rochromatine interstitielle comme le knob du chromo-
some 4, mais il existe aussi des re´gions plus petites (iloˆts d’he´te´rochromatine) situe´es
dans l’euchromatine et qui couvrent majoritairement des e´le´ments transposables (Berna-
tavichute et al. [3]). Nous savons aussi qu’il y a peu de diffe´rences entre le sauvage et le
mutant pour le taux de me´thylation d’H3K9me2. Nos re´sultats corroborent parfaitement
ces connaissances. En effet, on observe une majorite´ de sondes de´clare´es non me´thyle´es le
long du chromosome 4, mais dans la re´gion pe´ricentrome´rique (entre les positions 2 800 000
et 5 000 000) et autour du knob (entre les positions 1 600 000 et 2 300 000), on remarque
une majorite´ de sondes du groupe normal et des larges plages de sondes du groupe appau-
vri ou enrichi. On de´tecte aussi des plages de sondes, plus petites, appartenant au groupe
enrichi ou appauvri situe´es dans l’euchromatine et qui couvrent des e´le´ments transposables
(cf Figure 6). Environ 10% des sondes du ge´nome couvrent des e´le´ments transposables,
et on trouve 26% des sondes du groupe normal couvrant un e´le´ment transposable. Un
test du χ2 montre une diffe´rence significative. Il y a clairement un biais et on peut donc
dire que la marque H3K9me2 est majoritairement pre´sente sur les e´le´ments transposables.
Fig. 6 – Comparaison a` l’annotation. En bleu les ge`nes (1e`re ligne), en violet les e´le´ments
transposables (2e`me ligne). En rouge, les sondes ou` la me´thylation est identique entre le
sauvage et le mutant. En noir les sondes de´clare´es enrichies, en bleu les appauvries, en
jaunes les non-me´thyle´es (3e`me ligne).
c© Revue MODULAD, 2009 -65- Nume´ro 40
6 Conclusion
Nous proposons une me´thode fonde´e sur un me´lange de gaussiennes bidimension-
nelles contraintes pour l’analyse de donne´es de ChIP-chip IP/IP. La connaissance biolo-
gique des donne´es est prise en compte. Les parame`tres sont estime´s par l’algorithme EM.
Cette me´thode donne des re´sultats convaincants pour l’analyse d’un jeu de donne´es re´el
concernant la me´thylation d’une histone. Nous souhaitons aussi analyser d’autres types
de donne´es ou` il n’y aurait que 3 groupes a` de´finir (pas d’appauvri, pas d’enrichi ou pas
de non-immunopre´cipite´). Bien que notre mode`le ne prenne pas en compte la structure
spatiale des sondes le long du chromosome, les sondes de´clare´es normales, enrichies ou
appauvries sont regroupe´es sous forme de plage. Une ame´lioration naturelle consiste a`
prendre en compte la structure spatiale des sondes en utilisant un mode`le de type HMM.
D’autre part, on peut aussi rajouter des contraintes de syme´trie entre les groupes appau-
vri et enrichi.
Re´fe´rences
[1] Amaratunga, D. and Cabrera, J. : Exploration and Analysis of DNA Microarray and
Protein Array Data. Wiley Series in Probability and Statistics (2004).
[2] Banfield, J.D. and Raftery, A.E. : Model-based Gaussian and non-Gaussian cluste-
ring. Biometrics 49 (1993) 803-821.
[3] Bernatavichute, Y.V., Zhang, X., Cokus, S., Pellegrini, M. and Jacobsen, S.E. :
Genome-Wide Association of Histone H3 Lysine Nine Methylation with CHG DNA
Methylation in Arabidopsis thaliana. PLoS ONE 3(9) :e3156 (2008).
[4] Biernacki, C., Celeux, G., Echenim, A., Govaert, G. and Langrognet, F. : Le logiciel
MIXMOD d’analyse de me´lange pour la classification et l’analyse discriminante. La
Revue de Modulad 35 (2007) 25-44.
[5] Biernacki, C., Celeux, G. and Govaert, G. : Assessing a mixture model for clustering
with the integrated completed likelihood. Pattern Analysis and Machine Intelligence
22(7) (2000) 719-725.
[6] Boulicaut, J.F. and Gandrillon O. : Informatique pour l’analyse du transcriptome.
Lavoisier (2004).
[7] Buck, M.J. and Lieb, J.D. : Chip-chip : considerations for the design, analysis, and
application of genome-wide chromatin immunoprecipitation experiments. Genomics
83 (2004) 349-360.
[8] Cappe´, O., Moulines, E. and Ryde´n, T. : Inference in hidden Markov models. Springer
Series in Statistics, NY : Springer (2005).
[9] Cawley, S. et al. : Unbiased mapping of transcription factor binding sites along human
chromosomes 21 and 22 points to widespread regulation of noncoding RNAs. Cell 116
(2004) 499-509.
[10] Celeux, G. and Govaert, G. : Gaussian Parsimonious Clustering Models. Pattern
Recognition 28 (1995) 781-793.
c© Revue MODULAD, 2009 -66- Nume´ro 40
[11] Dempster, A.P., Laird, N.M. and Rubin, D.B. : Maximum likelihood from incomplete
data via the EM algorihtm (with discussion). J. R. Statis. Soc. B 39 (1977) 1-38.
[12] Ephraim, Y. and Merhav, N. : Hidden Markov processes. IEEE Transactions on
Information Theory 48(6) (2002) 1518-1569.
[13] Hupe´, P., Stransky, N., Thiery, JP., Radvanyi, F. and Barillot, E. : Analysis of array
CGH data : from signal ratio to gain and loss of DNA regions. Bioinformatics 20(18)
(2004) 3413-22.
[14] Keles, S. : Mixture modeling for genome-wide localization of transcription factors.
Biometrics 63 (2007) 10-21.
[15] Martin-Magniette, M-L, Mary-Huard, T., Berard, C. and Robin S. : ChIPmix : mix-
ture model of regressions for two-color ChIP-chip analysis. Bioinformatics 24 :i181-
i186 (2008).
[16] Olshen, AB., Venkatraman, ES., Lucito, R. and Wigler, M. : Circular binary seg-
mentation for the analysis of array-based DNA copy number data. Biostatistics 5(4)
(2004) 557-72.
[17] Picard, F., Robin, S., Lavielle, M., Vaisse, C. and Daudin, JJ. : A statistical approach
for array CGH data analysis. BMC Bioinformatics 6 :27 (2005).
[18] Turck, F., Roudier, F., Farrona, S., Martin-Magniette, M-L. et al. : Arabidopsis
TFL2/LHP1 Specifically Associates with Genes Marked by Trimethylation of Histone
H3 Lysine 27. PLoS Genet.v 3 :6 (2007).
c© Revue MODULAD, 2009 -67- Nume´ro 40
()
c© Revue MODULAD, 2009 -68- Nume´ro 40
