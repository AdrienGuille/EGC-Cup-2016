Apprentissage Automatique des Modeles Structurels
d'Objets Cartographiques
Guray Erus, Nicolas Lomenie
Universite de Paris 5, Laboratoire SIP-CRIP5.
45 rue des Saints Peres ; 75006 ; Paris ; France
fegur,Nicolas.Lomenieg@math-info.univ-paris5.fr
Resume. Pour reconna^tre les objets cartographiques dans les images
satellitales on a besoin d'un modele d'objet qu'on recherche. Nous avons
developpe un systeme d'apprentissage qui construit le modele structu-
rel d'objets cartographiques automatiquement a partir des images satel-
litales segmentees. Les images contenants les objets sont decomposees en
formes primitives et sont transformees en Graphes Relationnels Attribues
(ARGs). Nous avons genere les modeles d'objets a partir de ces graphes,
en utilisant des algorithmes d'appariement de graphes. La qualite d'un
modele est evaluee par la distance d'edition des exemples a ce modele.
Nous sommes parvenus a obtenir des modeles de ponts et de ronds-points
qui sont compatibles avec les modeles construits manuellement.
1 Introduction
1.1 Position du Probleme
Au sein du laboratoire SIP, dans le cadre d'un projet du CNES1, on a developpe
deux systemes de detection d'objets cartographiques sur les images satellitales. A la
phase terminale de ces systemes, on a utilise un modele de l'objet recherche, pour
determiner l'appartenance des candidats a une certaine classe d'objet. Ce modele
est genere manuellement, soit en utilisant des regles xes (Sanz et Lomenie), soit en
precisant des contraintes geometriques (Lomenie et al.). Notre objectif est de generer
ces modeles d'objets cartographiques automatiquement a partir d'une base d'images
satellitales segmentees. L'originalite de ce travail repose sur l'application de techniques
d'apprentissage structurel a des objets cartographiques complexes et tres variables.
Une etude detaillee de la reconnaissance d'objets en utilisant des modeles est
presentee dans (Pope). Dans la plupart des travaux, les objets sont representes par
des graphes et particulierement par des ARGs. (Petrakis et Faloutsos) proposent une
metrique de distance entre deux ARGs pour detecter les images semblables dans une
base de donnee images. Dans (Cordella et al.) on presente une methode d'apprentissage
des gures representees par des ARGs. L'objective d'apprentissage est de generer une
sequence des ARGs Generalises qui couvre tous les exemples. Une etude des algorithmes
d'appariement de graphes se trouve dans (Bunke).
Notre systeme se compose de deux modules (Fig. 1). Nous disposons d'une banque
de donnees-objets dans lequel des ponts et des ronds-points isoles sont extraites d'
1Centre National d'Etudes Spatiales
RNTI-E-3445
Apprentissage Automatique des Modeles Structurels d'Objets Cartographiques
Détection des formes
primitives
Détection des
connexion des formes
.
.
.

.
.
.

Transformation en
ARGs
Extraction des
prototypes et du
modèle
Evaluation du modèleImages
Segmentées
Images
Décomposées Modèle
d'Objet
Sous -graphe
Commun  Max.
Sur-graphe
Commun Min.
...................
Bas-niveau Haut-niveau
Fig. 1 { Le systeme general.
images SPOT5-THR a une resolution de 2,5 metres. L'objectif du module de pre-
traitement est la decomposition des images segmentees de ponts et de ronds-points en
gures geometriques primitives. Au deuxieme module, nous transformons les images
decomposees en ARGs. Nous determinons en suite les prototypes les plus frequents de
l'objet parmi tous les graphes et nous generons le modele a partir de ces prototypes.
Pour evaluer la qualite du resultat, la distance d'edition de chacun des graphes au
modele correspondant est calcule.
2 Decomposition en Figures Geometriques
En utilisant des gures geometriques simples, on peut obtenir une decomposition
qui preserve la topologie et les relations spatiales des parties d'un objet. Nous avons
propose deux decompositions en parallele, une par des cercles et des rectangles et une
autre par des cercles et des segments.
Nous avons d'abord detecte les cercles dans les images. La transformee de Hough
est une methode classique de detection des formes simples comme des droites et des
cercles dans une image. Nous avons utilise ce methode pour detecter les cercles dans
les images de ronds-points.
Pour detecter les rectangles, la premiere etape est l'extraction des contours en
utilisant le gradient morphologique. Le contour obtenu est une courbe. Pour approximer
ce courbe par des segments, nous avons utilise l'algorithme de la corde. Parmi tous les
segments, nous avons choisi les segments paralleles et detectes les rectangles encadrees
par ces segments paralleles. Les gures geometriques obtenues ne sont pas en general
connectees. Nous avons applique un methode de prolongation sur les rectangles pour
detecter leur connexions.
Avec l'objectif d'obtenir une approximation plus dele a l'image originale nous
avons propose une deuxieme decomposition en remplacant les rectangles par des seg-
ments. Pour extraire les segments, nous avons implemente l'algorithme d'amincissement
de Zhang-Suen. L'algorithme de la corde est utilise pour approximer le squelette obtenu
par des segments.
Quelques exemples representatives des resultats de la decomposition sont presentes
au gure 2.
RNTI - 1
RNTI-E-3 446
Erus et Lomenie
Images Originales
Décomposition  en Cercles  et Rectangles
Décomposition  en Cercles  et Segments
Fig. 2 { Les images decomposees.
3 Construction du Modele
3.1 Construction des ARGs
Les images decomposees sont transformees en ARGs. Les attributs des sommets
sont les suivants :
{ Le type (t) d'un sommet, choisi parmi un alphabet ni T = fcercle, rectangle,
segmentg de types possibles.
{ Les rectangles ont les attributs centre, longueur, largeur et angle avec l'horizontal.
Les segments ont les me^mes attributs que les rectangles sauf le largeur. Les cercles
ont les attributs centre et rayon.
Les valeurs de ces attributs sont representes par des entiers naturels. Les attributs des
arcs sont :
{ Le type de l'arc, un tuple de types des sommets connectes.
{ La direction de connexion qui est discretisee par l'ensemble fperpendiculaire,
paralleleg.
3.2 Detection des Prototypes
Nous avons propose une methode heuristique qui vise a reduire le nombre de graphes
en detectant les prototypes entre eux. Nous avons suppose que parmi les graphes ap-
partenant a une classe d'objet, plus le nombre d'occurrence d'un graphe augmente, plus
ce graphe devient representatif de l'objet. En groupant les graphes isomorphiques et
en triant les groupes par le nombre d'individu, nous avons obtenu les graphes les plus
frequents. Nous avons applique un algorithme d'appariement exact entre les graphes
pour detecter les graphes isomorphiques. Nous avons utilise un sous-ensemble des at-
tributs pour la comparaison des graphes, au lieu de comparer tous les attributs. Les
attributs utilises sont le type de sommet, le type de l'arc et la direction de
connexion. Les deux premiers attributs assurent l'appariement des gures et le dernier
RNTI - 1
RNTI-E-3447
Apprentissage Automatique des Modeles Structurels d'Objets Cartographiques
attribut assure l'appariement des relations spatiales entre les gures. Les prototypes
detectes manquent de valeur pour des attributs numeriques qui ne sont pas utilises
pour la comparaison des graphes. Pour determiner ces valeurs, dans chaque groupe on
utilise le graphe qui est le plus proche de la moyenne cumulative de ces attributs. Le
but de xer les valeurs manquants est de visualiser les prototypes obtenus.
3.3 La Construction du Modele
Nous considerons comme modele le treillis determine par le sous-graph commun
maximal (MaxSgC) et le sur-graph commun minimal (MinSgC) des prototypes, c'est
a dire tous les graphes G tels que G MinSgC et G MaxSgC.
Nous avons implemente un algorithme recursif pour trouver le MaxSgC commun
de deux ARGs G1 et G2 :
MaxSgC(G1; G2) =
8
>><
>>:
G2 si G2  G1
maxkMikfMig ou Mi =MaxSgC(G1; Gi); et
Gi = G2   si; 8si 2 Sommets(G2) sinon
Nous trouvons le MinSgC des deux graphes G1 et G2 en utilisant leur MaxSgC :
Soit M = MaxSgC(G1; G2). Le MinSgC(G1; G2) est obtenu en ajoutant (G1  M)
et (G2  M) a M .
Les attributs numeriques des modeles obtenues sont determine en utilisant les at-
tributs des prototypes comme on a fait a l'extraction des prototypes.
3.4 La Distance d'edition des Exemples au Modele
Pour evaluer la puissance representative du modele genere, nous avons calcule la
distance d'edition de chacun des graphes au modele en utilisant la metrique suivante
propose par (Bunke et Shearer) :
d(G1; G2) = 1 
k(MaxSgC(G1; G2)k
max(kG1k; kG2k)
Nous avons adapte cette metrique a des ARGs, en utilisant l'algorithme pour cal-
culer le MaxSgC des ARGs. Le metrique est deni pour trouver la distance entre deux
graphes. Pour calculer la distance d'un graphe G1 au modele M nous avons genere
G, l'ensemble de tous les graphes couverts par le modele et trouve le minimum des
distances de G1 a chaque element de G.
4 Les Resultats Experimentaux
Nous avons teste notre systeme sur 4 groupes de test : images de pont decomposees
par rectangles (PR) ou par segments (PS), et images de ronds-points decomposees par
cercles et rectangles (RPR) ou par cercles et segments (RPS). Nous avons utilise 62
images de ponts et 54 images de ronds-points.
RNTI - 1
RNTI-E-3 448
Erus et Lomenie
a
PR RPR
PS RPS
Fig. 3 { Les prototypes obtenus.
MaxSgC
MinSgC
PR PS RPR RPS
Fig. 4 { Les modeles obtenus.
Les prototypes obtenus sont presentes au gure 3. Le nombre de prototypes est
determine en precisant un seuil minimal pour le taux des graphes qui ont un apparie-
ment exact avec un des prototype. Le taux d'appariement est plus eleve pour PS et RPS .
C'est la consequence d'une decomposition plus regulier en utilisant les segments. Les
prototypes des ponts sont assez similaires pour tous les deux decompositions. Pourtant,
pour les ronds-points on a obtenu des prototypes dierents a cause des irregularites a
la connexions des routes avec des ronds-points.
Figure 4 presente les modeles obtenus a partir des prototypes detectes a l'etape
precedente. Les modeles sont simples et semblables aux modeles generes manuellement.
Ils representent assez bien les caracteristiques de l'objet recherche. Les deux dierents
algorithmes de decomposition ont donne presque le me^me modele de pont.
Pour evaluer la qualite d'un modele qualitativement, nous avons calcule la distance
d'edition de tous les graphes d'une me^me classe d'objet au modele de cette classe.
D'apres ce critere, le meilleur modele est obtenu a PS avec une distance d'edition
moyenne de 0.098. Ce moyen est 0.1572 pour PR, 0.165 pour RPS et 0.1874 pour RPR.
La distance moyenne des exemples au modele est assez petite pour tous les groupes.
5 Conclusions et Perspectives
Ce travail est un premier approche a un probleme assez large et dicile. Notre
objectif est d'obtenir un systeme coherent et complet qu'on pourra ameliorer avec des
extensions futures. Nous sommes parvenus a obtenir des modeles de ponts et de ronds-
RNTI - 1
RNTI-E-3449
Apprentissage Automatique des Modeles Structurels d'Objets Cartographiques
points assez proches des modeles generes manuellement. La selection des attributs des
ARGs est sans doute le point central du probleme. Notre representation est nalement
assez directe. La variance des objets geographiques nous a conduit a limiter le nombre
des attributs utilises a la construction du modele. Cette limitation a reduit la capa-
cite representative de notre systeme. Des ranements seraient souhaitables. Prendre
en compte les attributs numeriques, utiliser une modelisation oue des concepts sym-
boliques ou integrer les methodes issues du raisonnement qualitatif spatial peuvent
ameliorer les resultats.
La realisation de ce projet scientique a ete rendu possible gra^ce aux aides de :
{ CNES - Service Qualite, G. Pauc, J.C. Favard et J. Inglada
{ Le Service Culturel de l'Ambassade de France a Ankara et notamment Dr. Z.
Hamrouni.
References
Bunke H. (2000), Graph matching : Theoretical foundations, algorithms, and applica-
tions, in Proc. Vision Interface 2000, Montreal, 2000, 82 - 88.
Bunke H. and Shearer K. (1998), A Graph distance metric based on the Maximal
Common Subgraph, Pattern Recognition Letters, Vol. 19, 1998.
Cordella L. P., Foggia P., Sansone C., Vento M. (2002), Learning structural shape
descriptions from examples, Pattern Recognition Letters 23(12) : 1427-1437.
Lomenie N., Trias R., Barbeau J. (2003), Integrating Textural and Geometric Infor-
mation for an automatic bridge detection, IGARSS'03, Toulouse, France, juillet
2003.
Petrakis M. and Faloutsos C. (1995), Similarity Searching in Large Image Databases,
Technical Report 3388, Department of Computer Science, University of Maryland.
Pope A. (1994), Model-Based Object Recognition : A Survey of Recent Research, Tech-
nical Report 94-04, The University of British Columbia - Department of Computer
Science.
Trias R. et Lomenie L. (2003), Automatic bridge detection in high-resolution satellite
images, 3rd International Conference on Computer Vision Systems (ICCVS'03),
ser. LNCS. Graz, Austria : Springer, pp. 172-181, Apr. 2003.
Summary
A model of the target object is required for the recognition of cartographic objects
in satellite images. We developed a learning system that constructs the cartographic
object model automatically using a database of segmented satellite images. The images
containing the objects are decomposed into primitive gures and are transformed to At-
tributed Relational Graphs. We generated the object models applying graph-matching
algorithms on these graphs. The quality of a model is evaluated by the edit-distance of
the examples to the model. We obtained models of bridges and round-abouts compa-
tible with manually generated models.
RNTI - 1
RNTI-E-3 450
