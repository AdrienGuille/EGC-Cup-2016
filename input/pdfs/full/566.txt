 
©Revue MODULAD 2010  93  Numéro 42 
Clustering models for high dimensional, temporal, and dissimilarity 
data 
Maurizio Vichi 
Dip. Statistics Probability & Applied Statistics 
University “La Sapienza” Rome 
maurizio.vichi@uniroma1.it 
 
 
 1. Introduction 
Often data present a multiway structure, and they can be arranged into  a Three-way Data Set  X, 
i.e.,a set X of n × K × T values related to: K variables measured (observed, estimated) on n objects 
(individuals, products) at T occasions (assessors, times, locations, etc.). Let X1, X2, ..., XK be K 
quantitative variables observed on n units (objects) at T consecutive time points (Figure 1).  
The observed data can be arranged into a three-way longitudinal data set  
  [ ]TtIitxxx ikttititi ,...,1 , :),,...,,( 21 =∈=≡ ⋅yY  
where xijt is the value of the j-th variable collected on the i-th object at time t; I={1,...,n} J={1,...,k}  
and U={1,...,T}  are the set of indices pertaining to objects,  
variables and time points, respectively. 
For each object i, Y(i) ={yi.t t=1,...,T} describes a time trajectory of the i-th object  
according to the k examined variables. The trajectory Y(i) is geometrically represented by T-1 
segments connecting T  points yi.t of Mk+1. Two time trajectories in M 3 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
1 t.............2............... u
X1
X2
• •
••
•
•
•
•
•
••
•
•
•
•
•
•
•
•
xl.1
xi.1
 M 3 
Y(i)
Y(l)
xi.2
xi t. xi u.
xl.2
xl t. xl u.
t•
 
©Revue MODULAD 2010  94  Numéro 42 
 2. Trend, Acceleration and Velocities 
The observed objects can be represented as points of a vectorial Let Mk+1 be the metric space 
spanning the k variables and time. The problem to find a dissimilarity between trajectories is 
relevant. A distance between trajectories is defined as a function of distances between some 
characteristics of trajectories: VELOCITIES and ACCELERATIONS 
 
VELOCITY: Velocity of Y(i) is defined as the rate of change of i-th object position in a fixed time  
interval and  indicating the direction and versus of each segment of the trajectory  Y(i) for a given 
variable, i.e.: 
1,
1
1,
+
+
+
−=
tt
ijtijt
tijt s
xx
v
       (1)
 
Here St,t+1 is the interval from t to t+1. 
 
In particular: 01, >+tijtv  ( 01, <+tijtv ) if object i, for the j-th variable, presents an increasing (decreasing) 
rate of change of its position in the time interval from t to t+1; 01, =+tijtv  if the object i for the j-th 
variable, does not change position from t to t+1. 
 
In M2 velocity of each segment of the trajectory is the slope of the straight line passing through it. If 
velocity is negative (positive) the slope will be negative (positive) and the angle made by each 
segment of the trajectory with the positive direction of the t-axis will be obtuse (acute). 
 
ACCELERATION measures the variation of velocity of Y(i) in a fixed time interval. 
For each time trajectory Y(i), the acceleration of an object i in the interval from t to t+2  (Acceleration 
must be computed on two time intervals [t, t+1], [t+1, t+2]), denoted 2, +tts , is, for the j-th variable: 
 
 
2,
1,2,1
2,
+
+++
+
−=
tt
tijttijt
tijt s
vv
a .        (2) 
 
In particular: 02, >+tijta  ( 02, <+tijta ) if the object i, for the j-th variable, presents an increasing 
(decreasing) variation of velocity in the time interval from t to t+2; 02, =+tijta  if object i, for j-th 
variable, does not change velocity from t to t+2. 
Geometrically, acceleration of each pair of segments of trajectory represents their convexity or 
concavity. If acceleration is positive (negative) the trajectory of the two segments is convex 
(concave). 
Defined velocity and acceleration, we are now in position to evaluate differences between trends in 
a time point t, velocities and accelerations in a time interval. Let us first consider: 
 
 
©Revue MODULAD 2010  95  Numéro 42 
TRENDS Distance 
  ( ) ( )[ ]∑∑
=
−
=
−−=− −
T
t
tltitlti
T
t
tlti tt
trli
1
..
1
..1
1
2
..11 ..1..
'=),( XXΣXXXX XΣX ππδ  (3) 
where π1 is a suitable weight to normalize distances  and  t..X
Σ  is the dispersion matrix of X..t. 
differences between trend intensities, in a time point t, of objects i and l are evaluated according to a 
measure of distance between Xi.t and Xl.t, t ∈ T; 
  
VELOCITIES Distance  
( ) ( )[ ]∑∑ −
=
++
−
++
−
=
++ −−=− +− +
1
1
1,.1,.
1'
1,.1,.2
1
1
2
1,.1,.22 1,..1
1,..
=),(
T
t
ttlttittltti
T
t
ttltti tt
tt
trli VVΣVVVV VΣV ππδ  (4) 
where π2 is a suitable weight to normalize the velocity dissimilarity, and 1,.. +ttVΣ is the dispersion 
matrix of V..t.  
Matrix 
1
1,..
−
+ttVΣ  allows to measure the autocorrelation between time points t, t+1 
differences between velocities of objects i and l, in a time interval, are evaluated according  
   a    measure of distance between ),...,( 1,1,11,. ′= +++ tiktttitti vvv  and 1,. +ttlv , 1-1,...,= ut ; 
 
ACCELERATIONS distance 
( ) ( )[ ]∑∑ −
=
++
−
++
−
=
++ −−=− +− +
2
1
2,.2,.
1'
2,.2,.3
2
1
2
2,.2,.33 2,..1
2,..
=),(
T
t
ttlttittltti
T
t
ttltti tt
tt
trli AAΣAAAA AΣA ππδ  (5) 
where π3 is a suitable weight to normalize the acceleration dissimilarity, and 
1
2,..
−
+ttAΣ  is the 
dispersion matrix of A..t that allows to measure the autocorrelation between time points t , t+2. 
differences between accelerations of objects i and l, in a time interval, are evaluated according     to 
a measure of distance between ),...,( 2,2,12,. ′= +++ tiktttitti aaa  and 2,. +ttla , 2-1,...,= ut . 
 3. Dissimilarities between trajectories 
A dissimilarity between trends, velocities and accelerations of Y(i) and Y(l) is a  
mapping respectively from: 
 
©Revue MODULAD 2010  96  Numéro 42 
trends distances, i.e.:{ }Ttlit ∈ ),,(1δ to +ℜ ;  velocities distances, i.e.:{ }Ttlitt ∈ ),,(1+ ,2δ to 
+ℜ ; accelerations distance, i.e.:{ }Ttlitt ∈ ),,(2+ ,3δ to +ℜ . 
The additive mapping has been considered:  
 d(i,l)= ∑
=
−−
T
t
tlti
t1
2
..1 1
..XΣ
XXπ + ∑−
=
++ −
+
−
1
1
2
1,.1,.2 1
1,
T
t
ttltti
ttVΣ
VVπ ∑−
=
++ −
+
−
2
1
2
2,.2,.3 1
2,
T
t
ttltti
ttAΣ
AAπ  (6) 
 
 4. Optimization problem 
In a paper in progress Gorfarb, Summa and Vichi are clustering trajectories in a reduced space by 
using the T3CLUS Model (Rocci and Vichi, 2005). 
The T3CLUS is a clustering version of the well known Tucker3 (T3) model proposed by Tucker 
(1966) 
 Xn,KT = U KTG ,X  (CC′⊗BB′) + KTn,E .       (7) 
Since occasions refer to time, we do not suppose to synthesize it by means of components;  
thus, this dimension will remain unreduced.  
This implies that in the previous model matrix C is an identity matrix of order T, i.e., 
 Xn,KT = U KTG ,X  (I⊗BB′) + KTn,E .        (8) 
This model can be rewritten in frontal slabs form 
 X..t = U t..X BB′ + E..t.        (9) 
The estimation of the model according to the distance between trajectories is a   
Non-Ordinary LS problem  
∑
=
−−
T
t
tt
t1
2
....1 1
..
'
XΣ
BBXUXπ + ∑−
=
++ −
+
−
1
1
2
1,..1,..2 1
1,
'
T
t
tttt
ttVΣ
BBVUVπ + ∑−
=
++ −
+
−
2
1
2
2,..2,..3 1
2,
'
T
t
tttt
ttAΣ
BBAUAπ →      Min 
         U,B t..X , 1,.. +ttV , 2,.. +ttA  
subject to             
             [P1] 
B′B=IK 
U binary and row stochastic. 
 
 
©Revue MODULAD 2010  97  Numéro 42 
 5. Partitioning Models 
In the case the data are dissimilarities D the additive mapping (6) can be used, thus, in this case 
objects need to be partitioned from dissimilarity data. Three models can be used (Vichi, 2009). 
WELL STRUCTURED PERFECT MODEL (Figure1) 
D =  + E  
  (10) 
where: 
D  observed dissimilarity matrix   
P   WSP classification matrix   
1n is a vector of n ones,  
In is the identity matrix  
M is a (n×K) matrix,  
binary and row-stochastic,  
α1 heterogeneity within classes 
α2 isolation between classes  
0<α1≤α2.  
E error matrix  
 
Figure1: Well structured perfect clustering model 
 
WELL STRUCTURED CLASSIFICATION MODEL AND SQUARE K-MEANS (Figure 2) 
 
D =  + E     (11) 
 
where: 
D  observed dissimilarity matrix    
Q   WS classification matrix 
1n  vector of n ones,  
In the identity matrix of order n and   
M is a (n×K), binary and row-stochastic,  
DW matrix of heterogeneity within classes  
DB matrix of isolation between classes   
E error matrix  
Square K-means matrix  
R is not a classification matrix  
 
       Figure2:Well structured classification model 
12 16 10  2  3  4  6  7 18 20 17 13  1  8 19 11  5 14  9 15
40
42
44
46
48
50
52
 
©Revue MODULAD 2010  98  Numéro 42 
HIERARCHICAL PARTITIONING 
D =  + E     (12) 
Subject to  
DB is ultrametric matrix  
max DW ≤ min DB  
 
 
Figure 3: Example of Hierarchical partitioning model 
 
References 
 
ROCCI R, VICHI M. (2005). Three-mode Component Analysis with Crisp or Fuzzy Partition of 
Units. PSYCHOMETRIKA. vol. 70 n 4, pp. 715-736 ISSN: 0033-3123.  
TUCKER L.R. (1966). Some mathematical notes on three-mode factor analysis. 
PSYCHOMETRIKA, vol 31, 279-311. 
VICHI M., ROCCI R, H.A.L.KIERS. (2007). Simultaneous Component and Clustering models for 
three-way data: Within and Between Approaches. JOURNAL OF CLASSIFICATION. vol. 24 n1, 
pp. 71-98 ISSN: 0176-4268. 
VICHI M. (2008). Fitting Semiparametric Clustering Models to Dissimilarity Data, ADVANCES 
IN DATA ANALYSIS AND CLASSIFICATION, vol 2, 2, 121-161,ISSN:1862-5347 . 
 
 
