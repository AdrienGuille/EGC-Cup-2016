Actuariat et data mining: prise en compte des dépendances
Arthur Charpentier
ENSAE-CREST, France
arthur.charpentier@ensae.fr
Résumé. Cet article vise à présenter un outil central en modélisation et en re-
présentation de la dépendance entre risques: les copules. La corrélation n’ayant
pas de motivation en assurance, il convient de pouvoir utiliser des notions plus
générales, et nous verrons que les rangs sont en particulier des notions de pre-
mière importance. Nous évoquerons également les problèmes de corrélations
entre évènements extrêmes, particulièrement importants en gestion des risques.
1 Introduction et motivation
Les problèmes de dépendance et de corrélation en assurance ne sont pas nouveaux. On
prendra d’ailleurs le terme “corrélation” au sens littéraire du terme, c’est à dire un “rapport
de dépendance dû à un lien de cause à effet, ou un lien créé par une cause commune, dé-
terminée ou non”. En particulier on le distinguera de la notion de “mesure de corrélation au
sens de Pearson”, correspodant au coefficient (usuel) de corrélation (dont les propriétés seront
évoquées dans la Section. 2).
Frees et Valdez (1995) avait ainsi proposé une revue de la littérature sur les copules, et en
particulier les copules archimédiennes, en présentant des applications en assurance, avec en
particulier les “corrélations” entre les durées de vie dans un couple et l’impact sur la tarifica-
tion des primes sur deux têtes (assurance au dernier survivant, ou assurance veuvage), ou bien
sur la tarification de contrats de réassurance, avec la séparation entre les coûts des sinistres
(avec un traité non-proportionnel avec franchise) et les frais associées (partagés pro rata ca-
pita).
Dans le premier cas, si Tx et Ty désignent les durées de vie résiduelles d’un homme et d’une
femme respectivement d’âge x et y à la signature du contrat, on peut ainsi écrire les annuités
(c’est à dire les primes pour le versement d’un capital unitaire à terme échu) vie-jointes sous
la forme
axy:nq =
n∑
k=1
vkP(Tx > k et Ty > k) =
n∑
k=1
vkkpxy,
en utilisant les notations classiques d’assurance-vie, où kpx = P(Tx > k) désigne la proba-
bilité qu’une personne d’âge x aujourd’hui soit encore en vie dans k années. Les annuités au
dernier survivant s’écrivent sous la forme
axy:nq =
n∑
k=1
vkP(Tx > k ou Ty > k) =
n∑
k=1
vkkpxy,
- 147 - RNTI-A-1
Actuariat, Data mining et dépendance
ou encore, pour les annuités veuvage, on peut écrire
ax|y = ay − axy =
∞∑
k=1
vkP(Ty > k|Tx > k) =
∞∑
k=1
vkkpy −
∞∑
k=1
vkkpxy
où kpxy = P(Tx > k et Ty > k).
Dans le second cas, reprenons l’exemple du traité de reassurance, oùX est le coût d’un sinistre
(c’est à dire l’indeminité versée par l’assureur à l’assuré en cas de survenance d’un sinistre), et
Y le montant des frais associés (frais d’expertise, frais d’avocats...). Considérons un traité de
réassurance en excès, de priorité d, où le réassureur verse une indemnité de la forme suivante
g(X,Y ) =
{
0, si X ≤ d,
X − d+ X − d
X
· Y , si X > d.
La prime pure est alors E(g(X,Y )) qui nécessite la connaissance de la loi jointe du couple
(X,Y ) puisque g est une fonction non-linéaire.
Au delà de l’utilisation des copules (présentées dans la Section 3, largement étudiées dans De-
nuit et Charpentier (2004), ou Denuit et al. (2005) pour modéliser les risques, et donc calculer
des primes, nous verrons que les copules sont également utiles pour l’exploration des données,
afin de mieux comprendre comment se comporte la corrélation entre les risques.
2 La corrélation comme mauvaise mesure de dépendance
La “mesure de corrélation au sens de Pearson” est souvent utilisée comme mesure de dé-
pendance. Mais si cette mesure a du sens en finance (où les lois Gaussiennes ou elliptiques sont
très utilisées), elle ne s’avère plus pertinente en assurance. Ceci est d’ailleurs générallement le
cas dès que l’on considère des variables aléatoires positives. La Figure 1 montre un couple de
variables exponentielles, dont on aurait bien du mal à dire si elles sont corrélées ou pas, et ce
que vaut la corrélation.
Rappelons que la corrélation r entre deux variables aléatoires X et Y de variance finie s’écrit
r(X,Y ) =
cov(X,Y )√
Var(X)Var(Y )
,
ou de manière équivalente
r(X,Y ) =
E[(X − E(X))(Y − E(Y ))]√
E[(X − E(X))2]E[(Y − E(Y ))2]
dès lors que Var(X),Var(Y ) < ∞. Si en finance il est d’usage d’étudier la volatilité d’un
rendement, il n’est pas rare d’avoir des coûts de sinistres de variance infinie, par exemple en
incendies entreprises, ou en perte d’exploitation. Il paraît troublant qu’on ne puisse pas évoquer
de corrélation entre deux risques, sous prétexte que les queues de distributions (marginales)
sont trop épaisses.
- 148 -RNTI-A-1
A. Charpentier
Random vector with exponential margins
0 1 2 3 4 5
0
1
2
3
4
5
Random vector with exponential margins
FIG. 1 – Couple (X,Y ) de variables exponentielles.
Un autre souci est lié à l’interprétation de cette corrélation, à supposer qu’elle existe. En effet,
d’après l’inégalité de Schwarz, r(X,Y ) ∈ [−1,+1]. Mais les bornes ne sont pas forcément
atteinte. En particulier r(X,Y ) = +1 si et seulement si Y = aX + b : il doit exister une
relation affine entre X et Y . En fait, il est possible de montrer que (Nelsen (1999))
rmin =
cov[F−1X (U), F
−1
Y (1− U)]√
V ar[X]V ar[Y ]
≤ r(X,Y ) ≤ cov[F
−1
X (U), F2Y
−1(U)]√
V ar[X1]V ar[Y ]
= rmax
où U ∼ U([0, 1]). Un exemple de ces bornes est obtenu dans le cas où X ∼ LN (0, 1) et
Y ∼ LN (0, σ), alors,(F−1X (U), F−1Y (1−U)) a la même distribution que (expZ, exp(−σZ)),
où Z ∼ N (0, 1). Aussi,
rmin =
exp(−σ)− 1√
(e− 1)(exp(σ2)− 1) et rmax =
exp(σ)− 1√
(e− 1)(exp(σ2)− 1) .
Ces deux bornes peuvent être visualisées sur la Figure 2.
Enfin, rappelons qu’une corrélation nulle - ou statistiquement très faible - n’indique pas grand
chose. Considérons l’exemple suivant, utilisé en modélisation du risque de crédit. SoientX1, ..., X1000
des variables indicatrices indiquant des défauts d’émetteurs dans un portefeuille de crédit, à
horizon d’un an,
Xi ∼ B(p), où p est à la probabilité de défaut = 10%.
Dans le cas où les émetteurs sont supposés indépendants, le nombre de défauts dans le porte-
feuille N vérifie N = X1 + ....+Xn ∼ B(n, p), une loi binomiale.
La Figure 3 montre ainsi la distribution de N dans le cas indépendant et dans un cas non-
indépendant, avec pourtant une corrélation quasiment nulle, puisque r(Xi, Xj) = 0.005.
Notons d’ailleurs qu’une corrélation positive ne suffit pas à définir une notion de “dépendance
positive”. La notion la plus classique de dépendance positive est dite de “dépendance positive
- 149 - RNTI-A-1
Actuariat, Data mining et dépendance
sigma
Pe
a r
so
n 
r
0 1 2 3 4 5
-
1.
0
-
0 .
5
0 .
0
0.
5
1.
0
r max
r min
FIG. 2 – Bornes pour la corrélation (au sens de Pearson) entre X ∼ LN (0, 1) et Y ∼
LN (0, σ), en fonction de σ.
0 50 100 150 200
0.
00
0.
01
0.
02
0.
03
0.
04
Number of defaults, n=1000, p=10%
0 50 100 150 200
0.
0
0.
2
0.
4
0.
6
0.
8
1.
0
Number of defaults, n=1000, p=10%
FIG. 3 – Impact de la corrélation sur le nombre de défauts dans un portefeuille obligataire,
r = 0 versus r = 0.005.
par quadrant” : un couple (X,Y ) est dit à dépendance positive si et seulement si
P(X > x, Y > y) ≥ P(X > x)× P(Y > y) = P(X⊥ > x, Y ⊥ > y),
pour tout x, y, ou de manière équivalente
P(X ≤ x, Y ≤ y) ≥ P(X ≤ x)× P(Y ≤ y) = P(X⊥ ≤ x, Y ⊥ ≤ y),
où le terme de droite correspond au cas indépendant. On peut visualiser cette notion sur la
Figure 4.
- 150 -RNTI-A-1
A. Charpentier
−3 −2 −1 0 1 2 3
−
3
−
2
−
1
0
1
2
3
Variables indépendentes
−3 −2 −1 0 1 2 3
−
3
−
2
−
1
0
1
2
3
Variables corrélées positivement
FIG. 4 – La notion de dépendance positive par quadrant.
3 Copules et rangs
Définition 1 En dimension 2, une “copule” C est une fonction de répartition sur [0, 1]2 dont
les lois marginales sont uniformes sur [0, 1].
Si (U, V ) est un couple dont les lois marginales sont uniformes sur [0, 1], notons C(u, v) =
P(U ≤ u, V ≤ v), la fonction de répartition associée. CommeC est une fonction de répartition
sur [0, 1]2, C(0, v) = C(u, 0) = 0 pour tout u, v ∈ [0, 1] car P(U ≤ 0) = P(V ≤ 0) = 0, et
de plus, C(1, 1) = 1. De plus, comme les lois marginales sont uniformes, C(1, v) = P(U ≤
1, V ≤ v) = P(V ≤ v) = v (car {U ≤ 1} est un évènement certain) pour tout u, v ∈ [0, 1].
Enfin,C vérifie une propriété de “croissance” car P est une mesure positive : pour tout u1 ≤ u2
et v1 ≤ v2, P(u1 < U ≤ u2, v1 < V ≤ v2) ≥ 0 se traduit par une relation de la forme
C(u2, v2)− C(u1, v2)− C(u2, v1) + C(u1, v1) ≥ 0.
Définition 2 De manière analytique, C est une copule si et seulement si C(0, v) = C(u, 0) =
0, C(u, 1) = u et C(1, v) = v pour tout u, v, avec la propriété de croissance suivante
C(u2, v2)− C(u1, v2)− C(u2, v1) + C(u1, v1) ≥ 0,
pour tout u1 ≤ u2 et v1 ≤ v2.
La Figure 5 permet de visualiser ainsi une copule, avec à gauche les propriétés de la fonction
C, et à droite une visualisation d’une telle fonction. La Figure de droite représente la densité
associée à cette fonction de répartition (si elle existe), qui correspond à la dérivée partielle
c(u, v) =
∂2C(u, v)
∂u∂v
.
Ces fonctions copules sont intéressantes de part le théorème de Sklar (Sklar (1959)). Si C
est une copule et si FX et FY sont deux fonctions de répartition (unidimensionnelles), alors
- 151 - RNTI-A-1
Actuariat, Data mining et dépendance
Valeurs sur le bord du carré unité
−0.2  0.0  0.2  0.4  0.6  0.8  1.0  1.2  1.4−
0
.2
 
0
.0
 
0
.2
 
0
.4
 
0
.6
 
0
.8
 
1
.0
 
1
.2
 
1
.4
−0.2 0.0
 0.2  0.4
 0.6  0.8
 1.0  1.2 X
Y
Z
Fonction de répartition à marges uniformes
x
x
z
Densité d’une loi à marges uniformes
FIG. 5 – Valeur de la fonction copule sur les bords du carré unité [0, 1]2, exemple de copule,
avec la fonction de répartition au centre, et la densité associée à droite.
F (x, y) = C(FX(x), FY (y)) est une fonction de répartition dans la classe de FréchetF(FX , FY ),
c’est à dire dont les lois marginales sont précisément FX et FY . Et réciproquement, si F ∈
F(FX , FY ), il existe une copule C telle que F (x, y) = C(FX(x), FY (y)). De plus, si FX et
FY sont continues, alors C est unique et donnée par
C(u, v) = F (F−1X (u), F
−1
Y (v)) pour tout (u, v) ∈ [0, 1]× [0, 1].
On peut alors parler de la copule de F , ou la copule du couple (X,Y ). Plus précisement dans
ce cas, notons que C est alors la fonction de répartition du couple (U, V ) où U = FX(X) et
V = FY (Y ).
Remarque 3 Au lieu de coupler les fonctions de répartition sous la forme
P(X ≤ x, Y ≤ y) = C(P(X ≤ x),P(Y ≤ y))
notons que nous aurions pu coupler les fonctions de survie, au sens où
P(X > x, Y > y) = C∗(P(X > x),P(Y > y)).
La fonctionC∗ est également une copule, que l’on appelera copule de survie du couple (X,Y ).
Notons que si C est la fonction de répartition d’un couple (U, V ), alors C∗ sera la fonction de
répartition d’un couple (1− U, 1− V ).
Une classe particulièrement importante de copules est la classe des copules “Archimédiennes”.
Soit φ : [0, 1] → [0,∞] une fonction décroissante convexe, telle que φ(0) = ∞ et φ(1) = 0,
alors C(u, v) = φ−1(φ(u) + φ(v)), est une copule.
Exemple 4 Si φ(t) = t−θ − 1, alors C(u, v) = (uθ + vθ − 1)−1/θ. On parlera de la copule
de Clayton.
- 152 -RNTI-A-1
A. Charpentier
Exemple 5 Si φ(t) = (− log t)−θ, C(u, v) = exp
(
− [(− log u)θ + (− log v)θ]1/θ). On
parlera de la copule de Gumbel.
On peut aussi construire une autre classe de copules - obtenue par exemple dans la modélisation
probit multivariée : les copules elliptiques, induites par les lois elliptiques en dimension 2.
Exemple 6 Pour α ∈ (−1, 1), on considère la copule C induite par le vecteur (X,Y ) gaus-
sien centré réduit, de corrélation α. Alors
C(u, v) =
1
2pi
√
1− α2
∫ Φ−1(u)
−∞
∫ Φ−1(v)
−∞
exp
{−(x2 − 2αxy + y2)
2(1− α2)
}
dxdy.
On parlera de la copule Gaussienne.
Exemple 7 Pour α ∈ (−1, 1) et ν ≥ 2, on considère la copuleC induite par le vecteur (X,Y )
de Student (t) centré réduit, de corrélation α, à ν degrés de liberté. Alors
C(u, v) =
1
2pi
√
1− α2
∫ t−1ν (u)
−∞
∫ t−1ν (v)
−∞
(
1 +
x2 − 2αxy + y2
2(1− α2)
)−((ν+2)/2)
dxdy.
On parlera de la copule t de Student.
D’un point de vue statistique, les lois marginales ne sont pas connues, et il convient de substi-
tuer une estimation de ces fonctions de répartition. Etant donné un échantillon {(Xi, Yi), i =
1, ..., n}, considérons les fonctions de répartition empiriques,
F̂X(x) =
#{observations Xi plus petites que x}
#{observations } =
1
n
n∑
i=1
1(Xi ≤ x).
On notera en particulier que
F̂X(Xj) =
#{observations Xi plus petites que Xj}
#{observations } =
1
n
n∑
i=1
1(Xi ≤ Xj) = Rj
n
,
où Rj désigne le rang de Xj au sein de l’échantillon {X1, ..., Xn}.
La version empirique de l’étude de la distribution du couple (FX(X), FY (Y )) est l’étude de
la distribution des pseudo-observations {(F̂X(Xi), F̂Y (Yi)), i = 1, ..., n}, ce qui correspond -
à un facteur 1/n près - à la loi jointe des rangs.
4 Visualisation de la densité : application aux données coût-
frais de sinistres
Comme toujours en statistique, une des méthodes les plus naturelles pour visualliser la
distribution de variables aléatoires est de représenter la densité - si possible une estimation
non-paramétrique de cette densité afin d’éviter les erreurs (possibles) de modèles.
- 153 - RNTI-A-1
Actuariat, Data mining et dépendance
1 2 3 4 5 6
1
2
3
4
5
Log−log scatterplot, Loss−ALAE
log(LOSS)
lo
g(A
LA
E)
0.0 0.2 0.4 0.6 0.8 1.0
0.
0
0.
2
0.
4
0.
6
0.
8
1.
0
Copula type scatterplot, Loss−ALAE
Probability level LOSS
Pr
ob
ab
ilit
y 
le
ve
l A
LA
E
FIG. 6 – Coûts des sinistres et frais associés, en échelle logarithmique, et rangs à droite
(copula-type scatterplot).
Considérons l’exemple des coûts de sinistres versus les frais associés. On se doute qu’une
corrélation positive existe, mais on souhaite en savoir plus, en particulier pour modéliser les
primes de réassurance évoquée dans l’introduction. La Figure 6 représente la base évoquée
dans Klugman et Parsa (1999) avec 1500 sinistres.
Au delà de l’intuition d’une forte dépendance dans la queue supérieure (les plus gros sinistres
étant associés aux frais les plus importants), la visualisation est plus délicate. On peut ainsi
représenter l’histogramme associé (Figure 7)
FIG. 7 – Histogramme des rangs des coûts des sinistres et des frais associés.
Mais cet histogramme manquant de régularité, il peut être intéressant (et naturel) de vou-
- 154 -RNTI-A-1
A. Charpentier
loir étudier une version lissée par noyau. Mais comme cela était évoqué dans Charpentier,
Fermanian et Scaillet (2006), les estimateurs à noyaux (usuels, à noyau symmétrique) sont
particulièrement inefficace si les données sont bornées, et c’est le cas dès lors que l’on se place
sur le carré unité. La densité en (0, 0) ou en (1, 1) est alors sous-estimée par un facteur 1/4 si
l’on considère un noyau symmétrique.
ĉ(u, v) =
1
n
n∑
i=1
K
(
Xi,
u
b
+ 1,
1− u
b
+ 1
)
·K
(
Yi,
v
b
+ 1,
1− v
b
+ 1
)
,
oùK(·, α, β) est la densité de la loi Beta de paramètres α et β.
La Figure 8 présente ainsi sur ces mêmes données l’estimation de la densité par noyau.
0.0 0.2 0.4 0.6 0.8 1.0
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.5
1.0
1.5
2.0
2.5
3.0
Estimation (classique) de la densité de la copule
0.2 0.4 0.6 0.8
0.2
0.4
0.6
0.8
0.0
0.5
1.0
1.5
2.0
2.5
3.0
Estimation (par noyau beta) de la densité de la copule
FIG. 8 – Visualisation de la densité de copule, avec un estimateur à noyau symmétrique (clas-
sique) et un noyau beta.
5 Corrélation entre risques extrêmes
Un point particulièrement important est celui de la corrélation entre risques extrêmes. On
se doute qu’une corrélation globale n’a que peu d’intérêt, si l’on s’intéresse à des scénarios de
contagion de crises en finance, ou de grands risques en réassurance.
Joe (1993) avait proposé d’utiliser la mesure de dépendance de queue suivante. Soit (X,Y ) un
couple de variables aléatoires et posons
λL = lim
u→0
P
(
X ≤ F−1X (u) |Y ≤ F−1Y (u)
)
,
et
λU = lim
u→1
P
(
X > F−1X (u) |Y > F−1Y (u)
)
,
si ces limites existent. On parlera alors de dépendance dans la queue inférieure (Lower) et
supérieure (Upper) respectivement. Ces mesures ne dépendant alors pas des lois marginales,
- 155 - RNTI-A-1
Actuariat, Data mining et dépendance
et on peut les définir à l’aide des copules, i.e.
λL = lim
u→0
C(u, u)
u
et λU = lim
u→1
C∗(u, u)
1− u ,
où C∗ est la copule de survie du couple (X,Y ).
Si λ = 0, on parlera d’indépendance entre extrêmes, et on dira que les risques extrêmes
sont corrélés si λ ∈]0, 1].
Exemple 8 Si (X,Y ) est un vecteur gaussien de corrélation r(X,Y ) < 1, alors λU = 0. Si
(X,Y ) admet pour une copule de Gumbel, de paramètre θ > 1, alors λU > 0. La Figure
9 compare ainsi les queues de distribution, pour une copule Gaussienne très très corrélées
globalement (corrélation de 0.95), et une copule de Gumbel qui globalement se rapproche
plus de l’indépendance. On notera que la copule de Gumbel présente effectivement plus de
scénarios extrêmes que la copule Gaussienne.
6 Application : mise à jour de prime d’assurance
En assurance, la prime pure correspond à l’espérance mathématique de la sinistralité pour
un contrat. Pascal et Fermat au XVIIIème siècle avaient déjà proposé d’utiliser ce “produit
scalaire entre les probabilités et les gains” pour trouver le prix d’un jeu, ou plutôt le prix juste
pour reprendre les termes de Feller (1943). Quételet avait d’ailleurs noté voilà plus d’un siècle
que cette valeur espérée avait une interprétation directe en assurance comme le prix assurant
un équilibre financier, en moyenne. Cette espérance trouve d’ailleurs beaucoup de justification
en statistiques (cf Denuit et Charpentier (2005)), puisqu’il s’agit de la constante approchant le
mieux une variable aléatoire, au sens L2, mais aussi des propriétés asymptotiques via la loi des
grands nombres ou le théorème central limite.
Afin d’éviter les problèmes d’antisélection, il convient néanmoins de segmenter les primes, en
prenant en compte des caractéristiques permettant de réveler de l’information sur la sinistralité
à venir. Par exemple en assurance automobile, lors de la tarification a priori, il est possible
d’utiliser des informations comportementales (âge et sexe du conducteur, ancienneté du per-
mis, lieux d’habitation et de travail...) ou liées au véhicule (puissance, âge, vitesse de pointe,
carburant...). Des méthodes de scoring ou de régression permettent alors d’attibuer un prix à
tout client se présentant.
Lors d’un changement de grille tarifaire, on peut ainsi, en regroupant des classes, en changeant
le découpage de variables continues, ou en utilisant d’autres variables tarifaires, changer signi-
ficativement le prix, à caractéristiques idéentiques. La Figure 10 montre ainsi l’ancien prix (sur
l’axe horizontal) et le nouveau prix (sur l’axe vertical), sur une population test. La figure de
gauche représente le nuage des prix des 12 000 polices, (Xi, Yi)i=1,...,n, et à droite le nuage
de points des rangs, (Ui, Vi)i=1,...,n où
Ui = F̂X(Xi) =
1
n
n∑
j=1
1(Xj ≤ Xi) et Vi = FY (Yi).
Les traits sur la figure de droite correspondent à une régression quantile sur les rangs.
- 156 -RNTI-A-1


A. Charpentier
Wiley.
Frees, E., Valdez, E., 1995. Understanding Relationships Using Copulas, North American Ac-
tuarial Journal, 2, 1-25.
Klugman, S.A., Parsa, R. 1999. Fitting Bivariate Loss Distributions with Copulas. Insurance :
Mathematics and Economics, 24, 139-148.
Nelsen, R., 1999. An introduction to copulas. Springer.
Sklar, A., 1959. Fonctions de répartition à n dimensions et leurs marges. Publications de l’Ins-
titut de Statistique de L’Université de Paris, 8, 229-231.
Summary
This paper presents an important tool for modeling and visualizing risk dependence: cop-
ulas. Since correlation has no motivation in insurance, more general concepts are necessary,
and we will see that ranks have particularly interesting properties. Furthermore, we will also
mention correlation in tails, i.e. correlation between extremal events, which is a crucial issue
in risk management.
- 159 - RNTI-A-1
- 160 -RNTI-A-1
